---
layout: post
title: "vb语言Visual Basic第1遍学习"
date: 2019-07-22
tag: 语言language
---





## Mac终端运行vb

只能用windows系统；跑个虚拟机也是可以的

```xml
破机码 ： 874-0166152
windows10
visual Basic 6.0
```





## 发展



Visual Basic（简称VB）是Microsoft公司开发的一种通用的基于对象的程序设计语言，为结构化的、模块化的、面向对象的、包含协助开发环境的事件驱动为机制的可视化程序设计语言。是一种可用于微软自家产品开发的语言。 

“Visual” 指的是开发图形用户界面 (GUI) 的方法——不需编写大量代码去描述界面元素的外观和位置，而只要把预先建立的对象add到屏幕上的一点即可。 “Basic”指的是 BASIC (Beginners All-Purpose Symbolic Instruction Code) 语言，是一种在计算技术发展历史上应用得最为广泛的语言。



Visual Basic 1.0 Windows 版本 =1991-04 =*.NET Framework 引入之前*

| 1998-10    | Visual Basic 6.0-.NET Framework 引入之前；*08年结束支持。*   |
| ---------- | ------------------------------------------------------------ |
| 2014-11-13 | Visual Studio 2015；Windows、iOS 以及 Android 应用开发；引入之后 |

**c与vb比较**

```
VB一般是没接触过编程的新人入门用的。或者非专业程序员拿来做一些小程序玩。
VB不是没用，比如一般人办公用的office软件excel，其本身使用的VBA就是VB。优点简单，面向界面的开发，基本学个两天，鼠标拖拖拽拽就能拉出个界面。你如果是一般工作人，会VB，可以自己写点自动化办公程序辅助自己工作。
但是如果想走程序员，99%都会选择学C语言，不论以后用其他什么语言写代码。因为这是基础。VB更偏向于是一种工具。

c与vb比较
C是一门计算机语言
VB是一个集成开发环境（但是人们通常也用它指代面向对象的BASIC语言）;
C是编译型语言（执行速度快），VB是解释型语言(执行速度慢);
C比VB更底层（即接近机器）;
C的能力比VB更强(内存操作、中断处理、任务调度);
C的应用范围比VB更大(VB编写的程序只能在windows上运行);
VB可以做到的功能，C都可以办到，并且C可以跨平台(在windows/linux/unix上可以共享代码）。
VB以及用VB写的程序只能在WINDOWS系统上使用，C无此限制（C最初是UNIX系统的工作语言）。
```





```vb
Shell函数是VB中的内部函数，它负责执行一个可执行文件，返回一个Variant(Double)，如果成功的话，代表这个程序的进程ID，若不成功，则会返回0。
Shell的语法：Shell(PathName[，WindowStyle])。
PathName 为必需参数。类型为String，它指出了要执行的程序名，以及任何需要的参数或命令行变量，也可以包括路径名。
WindowStyle为可选参数。Integer类型，指定在程序运行时窗口的样式。WindowStyle有以下这些值。
常量 值 描述
VbHide 0 窗口被隐藏，且焦点会移到隐式窗口。
VbNormalFocus 1 窗口具有焦点，且会还原到它原来的大小和位置。
VbMinimizedFocus 2 窗口会以一个具有焦点的图标来显示（缺省值）。
VbMaximizedFocus 3 窗口是一个具有焦点的最大化窗口。
VbNormalNoFocus 4 窗口会被还原到最近使用的大小和位置，而当前活动的窗口仍然保持活动。
VbMinimizedNoFocus 6 窗口会以一个图标来显示，而当前活动的窗口仍然保持活动
SHELL函数的第一个参数是可以设定为相对路径的。举个例子，在程序同一目录下有个文件example.exe：
Private Sub Form_Load()
Dim a As Integer
a = Shell(App.Path & "\example.exe",vbNormalFocus)
End Sub
打开一个example.exe文件
在VB中SHELL函数的使用仅限制于 *.exe *.com *.bat 等类型的文件。
```



## VB笔记

**一、VB与Basic**
VB之所以叫做“Visual Basic”就是因为它使用了Basic语言作为代码，所以它们之间有着千丝万缕的关系，如果学过Basic的话，看到VB的程序结构会感到很亲切。但VB作为新生物，也超越了Basic的限制，有了许多自己的特点：

VB建立了一种新的变量类型――货币型变量，通过使用仅带有二位小数的货币变量，就能避免因使用实型变量而带来的数值积累误差问题。
VB在调用函数（Function）时，必须在函数名后跟一对括号。
VB对白兰地使用范围重新做了规范，在Basic里把隐含变量都当作全局变量，而在VB里对隐含变量都当作局部变量。
VB里的说明语句（Declare），仅支持动态链结库（DLL）的子程序和无变量函数。
使用数组，必须事先用Dim或Redim进行定义。

**二、注释语句**

在使用注释语句之前必须先了解注释的作用，注释不仅仅是对程序的解释，有时它对于程序的调试也非常有用，譬如说可以利用注释屏蔽一条语句以观察变化，发现问题和错误。以后注释语句将是我们在编程里最经常用到的语句之一。
在VB里，注释语句有两种，一种是用“Rem”关键字，这跟DOS里的批处理文件的用法一样，还有一种是利用单引号“’”，例如：

‘Dim a As String 与
Rem Dim a As String 的作用是一致的。

**三、长语句的分行**
在比较早的版本中，因为没有象C等语言用“；”隔开语句与语句，VB的语句是必须写在一行里的，不过后来版本的VB里如许用分行符“_”把一个长语句分成若干行来存放。
四、条件语句

如果你学过任何一种编程的话，都会知道在程序里控制其流程的有两种语句，条件与循环，VB自然也不例外，其实不管哪种语言，条件和循环的样子都差不多，只不过各有各的规矩罢了。

在条件语句里，我们先来学习“If……Then……”语句。

它的一般语法是：

```vb
If <条件> Then

<语句>
<语句>
………

End If
```

与C 语言不同，VB的条件语句更符合英语的语法，如果Then后面所跟的语句只有一条，可以写成：

```vb
If <条件> Then <语句>

而不用End If。

有时我们还会用到

If <条件> Then
  <语句>
Else
  <语句>
End If

更可以在Else里在嵌套If语句，如：

If <条件> Then
  <语句>
Else If
  <语句>
Else
  <语句>
End If
```


用了过多的Else后你会感到很不方便，而且程序结构也不清晰，所以大多数的语言还有Select语句帮助解决这个问题。

VB里的Select语句的格式是这样的：

```vb
Select Case <变量名>
Case <情况1>
  ……
Case <情况2>
  ……
Case <情况3>
  ……
  …… ……
Case Else
  ……
End Select

例如：

Select Case a%

Case 1
  Print “a=1”
Case 2
  Print “a=2”
Case Else
  Print “a does not equal to 1 or 2.”

End Select
```



**五、循环语句**

循环结构是计算机语言里一种重要的结构，它的应用广泛，最简单的例子是累加器的作用，还可以用于穷举法，更直观的例子是把某件事重复指定的次数，这样就不用把要重复的语句输入多次，而通过循环结构完成，非常方便。

C语言里有一个“for”循环语句，VB里也有“For”关键字，作用也差不多，只是VB的“For”语句更容易理解。它的格式是：

For <循环变量>=<初赋值> To <终值> [Step <步长>]

……
……

Next <循环变量>

在默认情况下，Step被设为“1”，可以省略，Step也可以设为负值，例如：

Dim a=0

For I=1 To 10

a=a+I

Next I

这是一个最简单的累加器的例子，把1到10累加在一起，然后赋值给“a”这样的效果和上面是一样的，只不过是倒着加罢了，请看：

```vb
Dim a=0
For I=10 To 1 Step –1
a=a+I
Next I
```



While语句也是一个很常用的循环语句，它的形式很多



```
Do While …… Loop语句
	While …… Wend 语句
	Do …… Loop While
```

While后面都跟逻辑条件判断，“Do While …… Loop语句”和“While …… Wend 语句”作用相似，都是先判断While后面的条件是否为“真”，如果为“真”则执行里面的语句，如果为“假”，则退出循环，循环直至条件为“假”终止。“Do …… Loop While ”与前两者的区别在于，它不管条件的真假，都会先执行“Do”后面的语句，也就是说，它至少执行语句一次。
与While用法相似的还有Until语句，它是直至条件为真则终止循环，句式把While上述三个语句的While换成Until即可，但是因为容易记混，所以我建议只用While即可。Until <条件>可以相当于While Not <条件>。
For循环和Whlie循环应当根据适当的环境使用，它们有时也可替换。

> **六、运算操作**
> **数学运算**
> 	＋：加法运算，也适合于字符串的之间的合并运算。
> 	－：加法运算。
> 	*：乘法运算。
> 	/：除法运算。
> 	\：整除运算。
> 	Mod：求余运算。例如：a Mod b表示a被b整除以后的余数。
> 	^：幂运算。A^B表示以A为底的B次方。
> **关系运算**
> 关系运算也称比较运算，它表示不等式的真或假，VB共提供六种运算符，分别是=（等于），>（大于），<（小于），>=（大于等于），<=（小于等于）和<>（不等于）。
> **逻辑运算**
> 逻辑运算是对真或假的运算：

```
非And 与 Or 或 	Xor
异或Eqv
相等Imp
蕴含
```




**七、 数据与定义**

本标题的内容已经在上一章向大家详述过，在这里就不再重复。

**八、函数与过程**

函数与过程有许多相似的地方，它们之间最大也是最本质的区别就在于，函数有一个返回值，而过程只是执行一系列动作，所以可以简单的把函数理解成为一个变量，而VB中的每个事件都是一个过程，比如Command1_Click()就是一个过程。

因为在程序设计中经常会有重复的地方，所以把它做成一个函数或一个过程，在使用时进行调用，可以节省大量的输入代码的时间，而且使用函数和过程也便于程序的结构化和修改查看。函数和过程都可以有参数，也可以没有参数。

关于函数和过程我将在以后的章中配合实例讲解，请您继续留意VB教程。









## Vb常用语句

语句
1．赋值语句  (变量的赋值)
格式：
          [Let] <变量> ＝ <表达式>
			功能：先计算赋值号右边表达式的值，然后将值赋值给变量。
注意：

* “=” 意义是“赋值”而不是“等于”，x = y和y = x不等价。
* “=”左边只能是变量，不能是数值或表达式，下面语句是错误的：
  •	4 = x+y
  •	a + b/2 = 6
* ​	一次只能给一个变量赋值，如果要给多个变量赋相同的值，只能使用多个赋值语句。
  •	例如：sum = 0 : i = 0不能写成：sum = i = 0
  * ​	对象属性的动态设置、对象属性值的返回
    •	对象属性的动态设置
    •	格式：对象名.属性名 = <属性值>
    •	例如：Command1.Caption = "计算" 
    ​		Text2.Text=Str(c)
    •	注意：Name属性只能在属性窗口赋值
  * 对象属性值的返回
    •	例如：
    R = Val(Text1.Text)

(2)Print语句
    [<对象名>.]Print［<表达式表>］[，|；]
功能：在指定的对象上输出<表达式表>中各元素的值。
例

```vb
Private Sub Command1_Click()
      a = 123: b = 456: c = 789
      Form1.Print a; b; c        '输出在窗体Form1上
      Print "中华", "天下", a + b + c    ‘输出在窗体Form1上
      Picture1.Print "中华", "天下", a + b + c   '输出在图片框Picture1上
      Debug.Print "中华", "天下", a + b + c    '输出在立即窗口上
      Printer.Print "中华", "天下", a + b + c    '在打印机上输出
End Sub
```

注意：
只能在窗体、图片框、打印机、立即窗口上输出内容
Print的相关函数

```
①Tab()函数
Tab(N)
功能：把光标移到由N确定的位置。
②Spc()函数
Spc(N)
功能：光标移到N个空格之后的位置。
③Cls方法
 [<对象名>.]Cls
功能：清除由Print方法显示的信息。
④Format$函数 Format$（表达式，格式字符串）
功能：将数值、字符串或日期等数据按照指定的格式生成字符串
3.注释语句
Vb中添加注释语句的方法为在字符“’”(即单引号)后加注释内容或采用Rem 注释内容的形式
参照print语句中的例子
4..结束语句
语法格式：end
功能：强制程序结束运行
```







**练习：**

1.用vb语言编程序，分别为每个基本数据类型声明一个变量，给变量赋一个合适的值，使用print语句输出变量值
2.上机编写如下代码
Private Sub Form_Click()
Print “北京”,“奥运”
Print“北京”；“奥运”
表达式列表各输出项之间有分隔符。运行上面的程序说出逗号分隔符和分号分隔符的不同
采用逗号分隔符各输出项                                
采用分号分隔符各输出项                                
3.编写一个程序，用end语句结束这个程序，体会一下end语句的用法。
综合练习：
新建一工程，在窗体中有两个命令按钮，通过代码使一按钮显示“输出”，另一按钮显示“结束”。定义一变量a，类型为数值型且赋值123。定义一变量s, 类型为字符型且赋值为I am a student.要求当点击输出按钮时，用print语句输出“I am a student 学号位123”。点击结束按钮时，结束本程序。





**选择：**
1、在VB应用程序中，修改控制代码，使Command1按钮显示“end”，正确的设置是（）  。
A. Command1.Text=“end”   B. Command1.Caption=“end”
C. Command1.Name＝end    D. Command1.Caption=end
2、在VB程序中，当变量H的值等于8时，执行“IF H>8 then R=10 else R=20”语句后，R值为   （）  。
A．5    B．10    C．20        D．10或20
3．下列句子中，（） 不是赋值语句。
A．A=”123” +”456”        B．Label1.Captin=”你好！”     
C．r=Val(Text1.Text)        D．x+1=y 

4.下列程序运行后，变量s=    （）     。
Dim a,b,c,s As Integer
a=9
b=41
c=2*(a+b)
s=a*c
A．100    B．50    C．900    D．300
4.VB的注释语句是以（ ）开始的？ 
（A）Rem或'  （B）Rem或;  （C）Note或*  （D）Note或! 
5.针对下面的赋值语句，哪个叙述是正确的？
HA123=&HA456
（A）“=”左右两边的都是变量        （B）“=”左边的是变量，右边是常量 
（C）“=”左边的是常量，右边是变量  （D）“=”左右两边的都是常量 
6.下列哪个是结束程序的语句 
（A）End  （B）Stop  （C）Exit  （D）Pause 

​                                                                                                 

## 他山之石

```
https://wenku.baidu.com/view/4fac3103e87101f69e3195eb.html
```



