



## 参考

```sql
Last login: Wed May 22 20:55:18 on ttys000

(base) tianmini-2:~ tianzi$ mysql -uroot -p
mysql> use pyxm2
Database changed

mysql> CREATE TABLE `mst_stu` (
`name` varchar(255) DEFAULT NULL,
 `kecheng` varchar(255) DEFAULT NULL,
 `fenshu` int(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

Query OK, 0 rows affected (0.01 sec)

mysql> use fib

mysql> 
mysql> INSERT INTO `mst_stu` VALUES ('张三', '语文', 81);
Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_stu` VALUES ('张三', '数学', 75);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_stu` VALUES ('李四', '语文', 76);
Query OK, 1 row affected (0.01 sec)



mysql> INSERT INTO `mst_stu` VALUES ('李四', '数学', 90);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_stu` VALUES ('王五', '语文', 81);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_stu` VALUES ('王五', '数学', 100);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_stu` VALUES ('王五', '英语', 90);

Query OK, 1 row affected (0.00 sec)



mysql> select * from mst_stu;

+--------+---------+--------+

| name   | kecheng | fenshu |

+--------+---------+--------+

| 张三   | 语文    |     81 |

| 张三   | 数学    |     75 |

| 李四   | 语文    |     76 |

| 李四   | 数学    |     90 |

| 王五   | 语文    |     81 |

| 王五   | 数学    |    100 |

| 王五   | 英语    |     90 |

+--------+---------+--------+

7 rows in set (0.00 sec)



mysql> select name,min(fenshu) from mst_stu group by name;

+--------+-------------+

| name   | min(fenshu) |

+--------+-------------+

| 张三   |          75 |

| 李四   |          76 |

| 王五   |          81 |

+--------+-------------+

3 rows in set (0.00 sec)



mysql> select name,min(fenshu) from mst_stu group by name having min(fenshu)>80; 

+--------+-------------+

| name   | min(fenshu) |

+--------+-------------+

| 王五   |          81 |

+--------+-------------+

1 row in set (0.00 sec)



mysql> select name from(select name,min(fenshu) from mst_stu group by name having min(fenshu)>80);

ERROR 1248 (42000): Every derived table must have its own alias

mysql> select name from(select name,min(fenshu) from mst_stu group by name having min(fenshu)>80) as s

​    -> ;

+--------+

| name   |

+--------+

| 王五   |

+--------+

1 row in set (0.00 sec)



mysql> select select name,min(fenshu) from mst_values

​    -> group by name

​    -> having min(fenshu)>80;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select name,min(fenshu) from mst_values

group by name

having min(fenshu)>80' at line 1

mysql> 

mysql> 

mysql> select name,min(fenshu) from mst_stu

​    -> group by name

​    -> having min(fenshu)>80;

+--------+-------------+

| name   | min(fenshu) |

+--------+-------------+

| 王五   |          81 |

+--------+-------------+

1 row in set (0.00 sec)



mysql> 

mysql> 

mysql> select name from

​    -> (select name,min(fenshu) from mst_stu

​    -> group by name

​    -> having min(fenshu)>80

​    -> ) s;

+--------+

| name   |

+--------+

| 王五   |

+--------+

1 row in set (0.00 sec)



mysql> select name from

​    -> (select name,min(fenshu) from mst_stu

​    -> group by name

​    -> having min(fenshu)>80

​    -> ) ;

ERROR 1248 (42000): Every derived table must have its own alias

mysql> 

mysql> 

mysql> select name from

​    -> (select name,min(fenshu) from mst_stu

​    -> group by name

​    -> having min(fenshu)>80

​    -> ) mst ;

+--------+

| name   |

+--------+

| 王五   |

+--------+

1 row in set (0.00 sec)



mysql> CREATE TABLE `mst_weather` (

​    ->   `id` int(10) unsigned NOT NULL AUTO_INCREMENT,

​    ->   `date` date DEFAULT NULL,

​    ->   `temperature` int(255) DEFAULT NULL,

​    ->   PRIMARY KEY (`id`)

​    -> ) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4;

Query OK, 0 rows affected (0.00 sec)



mysql> INSERT INTO `mst_weather` VALUES (1, '2013-04-01', 20);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_weather` VALUES (2, '2013-04-02', 25);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_weather` VALUES (3, '2013-04-03', 21);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_weather` VALUES (4, '2013-04-04', 24);

Query OK, 1 row affected (0.00 sec)



mysql> select sid from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(sdate,sdate) = 1 and stemperature > stemperature;

ERROR 1054 (42S22): Unknown column 'sid' in 'field list'

mysql> select sid from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(sdate,sdate) = 1 and stemperature > stemperature;

ERROR 1054 (42S22): Unknown column 'sid' in 'field list'

mysql> select sid from mst_weather s1

​    -> join mst_weather s2

​    -> on datediff(sdate,stdate) = 1 and stemperature > stemperature; 

ERROR 1054 (42S22): Unknown column 'sid' in 'field list'

mysql> select s1.id from mst_weather s1

​    -> join mst_weather s2

​    -> on datediff(sdate,stdate) = 1 and stemperature > stemperature;

ERROR 1054 (42S22): Unknown column 'sdate' in 'on clause'

mysql> select s1*,s2* 

​    -> from mst_weather s1

​    -> join mst_weather s2;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',s2* 

from mst_weather s1

join mst_weather s2' at line 1

mysql> select id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2;

ERROR 1052 (23000): Column 'id' in field list is ambiguous

mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> ;

+----+-------------+-------------+

| id | temperature | temperature |

+----+-------------+-------------+

|  1 |          20 |          20 |

|  2 |          25 |          20 |

|  3 |          21 |          20 |

|  4 |          24 |          20 |

|  1 |          20 |          25 |

|  2 |          25 |          25 |

|  3 |          21 |          25 |

|  4 |          24 |          25 |

|  1 |          20 |          21 |

|  2 |          25 |          21 |

|  3 |          21 |          21 |

|  4 |          24 |          21 |

|  1 |          20 |          24 |

|  2 |          25 |          24 |

|  3 |          21 |          24 |

|  4 |          24 |          24 |

+----+-------------+-------------+

16 rows in set (0.00 sec)



mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> 

​    -> 

​    -> 

​    -> 

​    -> on datediff(s1.sdate,s2.stdate) = 1 and s1.stemperature > s2.stemperature; 

ERROR 1054 (42S22): Unknown column 's1.sdate' in 'on clause'

mysql> 

mysql> select name from mst_stu group by name having min_f > 80；

​    -> ///

​    -> 

​    -> 

​    -> 

​    -> 

​    -> ;;;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '//' at line 2

ERROR: 

No query specified



ERROR: 

No query specified



mysql> select name from mst_stu group by name having min(fenshu) > 80；

​    -> 

​    -> ;

ERROR 1054 (42S22): Unknown column '80；' in 'having clause'

mysql> 

mysql> 

mysql> select name from mst_stu group by name having min(fenshu) > 80;

+--------+

| name   |

+--------+

| 王五   |

+--------+

1 row in set (0.00 sec)



mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on datediff(s1.sdate,s2.stdate) = 1 

​    -> where s1.stemperature > s2.stemperature; 

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'where clause'

mysql> 

mysql> select s1.id from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(s1.date,s2.date) = 1 and s1.stemperature > s2.stemperature;

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'

mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1;

+----+-------------+-------------+

| id | temperature | temperature |

+----+-------------+-------------+

|  2 |          25 |          20 |

|  3 |          21 |          25 |

|  4 |          24 |          21 |

+----+-------------+-------------+

3 rows in set (0.00 sec)



mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 and s1.stemperature>s2.stemperature;

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'

mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.stemperature>s2.stemperature;

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'where clause'

mysql> 

mysql> select s1.id,s1.temperature

​    -> from

​    -> (select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.stemperature>s2.stemperature) as s;

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'where clause'

mysql> select s1.id,s1.date from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(s1.date,s2.date) = 1 and s1.stemperature > s2.stemperature;  

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'

mysql> select s1.id from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(s1.date,s2.date) = 1 and s1.stemperature > s2.stemperature;  

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'

mysql> select * from mst_weather;

+----+------------+-------------+

| id | date       | temperature |

+----+------------+-------------+

|  1 | 2013-04-01 |          20 |

|  2 | 2013-04-02 |          25 |

|  3 | 2013-04-03 |          21 |

|  4 | 2013-04-04 |          24 |

+----+------------+-------------+

4 rows in set (0.01 sec)



mysql> select s1.id from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(s1.date,s2.date) = 1 and s1.stemperature > s2.stemperature;  

ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'

mysql> ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'

​    -> ;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ERROR 1054 (42S22): Unknown column 's1.stemperature' in 'on clause'' at line 1

mysql> select s1.id from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(s1.date,s2.date) = 1 and s1.temperature > s2.temperature;  

+----+

| id |

+----+

|  2 |

|  4 |

+----+

2 rows in set (0.00 sec)



mysql> select s1.id,s1.date from mst_Weather s1 

​    -> join mst_Weather s2 

​    -> on datediff(s1.date,s2.date) = 1 and s1.temperature > s2.temperature;  

+----+------------+

| id | date       |

+----+------------+

|  2 | 2013-04-02 |

|  4 | 2013-04-04 |

+----+------------+

2 rows in set (0.00 sec)



mysql> select s1.id,s1.temperature

​    -> from

​    -> (select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature) as s

​    -> ;

ERROR 1060 (42S21): Duplicate column name 'temperature'

mysql> select s1.id,s1.date

​    -> from

​    -> (select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature) as s

​    -> ;

ERROR 1060 (42S21): Duplicate column name 'temperature'

mysql> select s1.id,s1.temperature,s2.temperature 

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature;

+----+-------------+-------------+

| id | temperature | temperature |

+----+-------------+-------------+

|  2 |          25 |          20 |

|  4 |          24 |          21 |

+----+-------------+-------------+

2 rows in set (0.00 sec)



mysql> select s1.id,s1.date

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature;

+----+------------+

| id | date       |

+----+------------+

|  2 | 2013-04-02 |

|  4 | 2013-04-04 |

+----+------------+

2 rows in set (0.00 sec)



mysql> select s1.id,s1.date

​    -> from

​    -> (select s1.*

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature) as s;

ERROR 1054 (42S22): Unknown column 's1.id' in 'field list'

mysql> select s1.*

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature

​    -> ;

+----+------------+-------------+

| id | date       | temperature |

+----+------------+-------------+

|  2 | 2013-04-02 |          25 |

|  4 | 2013-04-04 |          24 |

+----+------------+-------------+

2 rows in set (0.00 sec)



mysql> select s.id,s.date

​    -> from

​    -> (select s1.*

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature) as s;

+----+------------+

| id | date       |

+----+------------+

|  2 | 2013-04-02 |

|  4 | 2013-04-04 |

+----+------------+

2 rows in set (0.01 sec)



mysql> select s1.*

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature

​    -> group by s1.id;

+----+------------+-------------+

| id | date       | temperature |

+----+------------+-------------+

|  2 | 2013-04-02 |          25 |

|  4 | 2013-04-04 |          24 |

+----+------------+-------------+

2 rows in set (0.01 sec)



mysql> 

mysql> select s1.*

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature

​    -> group by s1.id desc;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'desc' at line 6

mysql> select s1.*

​    -> from mst_weather s1

​    -> join mst_weather s2

​    -> on day(s1.date)-day(s2.date) = 1 

​    -> where s1.temperature>s2.temperature

​    -> order by s1.id desc;

+----+------------+-------------+

| id | date       | temperature |

+----+------------+-------------+

|  4 | 2013-04-04 |          24 |

|  2 | 2013-04-02 |          25 |

+----+------------+-------------+

2 rows in set (0.00 sec)



mysql> create table 'mst_zhubo'(

​    -> 'zhubo_id' int(11) not null,

​    -> 'level' int(255) default null,

​    -> 'get' int(255) default null)

​    -> engine = innodb default charset = utf8mb4;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''mst_zhubo'(

'zhubo_id' int(11) not null,

'level' int(255) default null,

'get' i' at line 1

mysql> CREATE TABLE `mst_zhubo` (

​    ->   `zhubo_id` int(11) NOT NULL,

​    ->   `level` int(255) DEFAULT NULL,

​    ->   `gap` int(255) DEFAULT NULL

​    -> ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

Query OK, 0 rows affected (0.00 sec)



mysql> INSERT INTO `mst_zhubo` VALUES (123, 9, 20);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_zhubo` VALUES (123, 9, 40);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_zhubo` VALUES (123, 9, 30);

Query OK, 1 row affected (0.01 sec)



mysql> INSERT INTO `mst_zhubo` VALUES (246, 6, 30);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_zhubo` VALUES (246, 6, 20);

Query OK, 1 row affected (0.00 sec)



mysql> 

mysql> 

mysql> select zhubo_id,max(level) from mst_zhubo GROUP BY zhubo_id;

+----------+------------+

| zhubo_id | max(level) |

+----------+------------+

|      123 |          9 |

|      246 |          6 |

+----------+------------+

2 rows in set (0.00 sec)



mysql> select * from mst_zhubo where (zhubo_id,level) in (select zhubo_id,max(level) from mst_zhubo GROUP BY zhubo_id) ;

+----------+-------+------+

| zhubo_id | level | gap  |

+----------+-------+------+

|      123 |     9 |   20 |

|      123 |     9 |   40 |

|      123 |     9 |   30 |

|      246 |     6 |   30 |

|      246 |     6 |   20 |

+----------+-------+------+

5 rows in set (0.00 sec)



mysql> select zhubo_id,level,min(gap) 

​    -> from mst_zhubo where (zhubo_id,level) in (select zhubo_id,max(level) from mst_zhubo GROUP BY zhubo_id)

​    -> GROUP BY zhubo_id,level;

+----------+-------+----------+

| zhubo_id | level | min(gap) |

+----------+-------+----------+

|      123 |     9 |       20 |

|      246 |     6 |       20 |

+----------+-------+----------+

2 rows in set (0.00 sec)



mysql> select zhubo_id,max(level) from mst_zhubo

​    -> ;

ERROR 1140 (42000): In aggregated query without GROUP BY, expression #1 of SELECT list contains nonaggregated column 'pyxm2.mst_zhubo.zhubo_id'; this is incompatible with sql_mode=only_full_group_by

mysql> select zhubo_id,level,min(gap) from mst_zhubo where (zhubo_id,level)

​    -> in 

​    -> (select zhubo_id,max(level) from mst_zhubo GROUP BY zhubo_id)

​    -> ;

ERROR 1140 (42000): In aggregated query without GROUP BY, expression #1 of SELECT list contains nonaggregated column 'pyxm2.mst_zhubo.zhubo_id'; this is incompatible with sql_mode=only_full_group_by

mysql> INSERT INTO `mst_zhubo` VALUES (123, 8, 20);

Query OK, 1 row affected (0.01 sec)



mysql> select zhubo_id,level,min(gap) from mst_zhubo where (zhubo_id,level)

​    -> in 

​    -> (select zhubo_id,max(level) from mst_zhubo GROUP BY zhubo_id)

​    -> GROUP BY zhubo_id,level;

+----------+-------+----------+

| zhubo_id | level | min(gap) |

+----------+-------+----------+

|      123 |     9 |       20 |

|      246 |     6 |       20 |

+----------+-------+----------+

2 rows in set (0.00 sec)



mysql> CREATE TABLE `mst_class` (

​    ->   `class_id` varchar(255) NOT NULL,

​    ->   `grade` varchar(255) DEFAULT NULL,

​    ->   `rate` varchar(255) DEFAULT NULL

​    -> ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

Query OK, 0 rows affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('abc123', 'primary', '70%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('abc123', 'middle', '65%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('abc123', 'high', '72%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('hjkk86', 'primary', '69%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('hjkk86', 'middle', '63%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('hjkk86', 'high', '74%');

Query OK, 1 row affected (0.00 sec)



mysql> 

mysql> 

mysql> 

mysql> select * from mst_class;

+----------+---------+------+

| class_id | grade   | rate |

+----------+---------+------+

| abc123   | primary | 70%  |

| abc123   | middle  | 65%  |

| abc123   | high    | 72%  |

| hjkk86   | primary | 69%  |

| hjkk86   | middle  | 63%  |

| hjkk86   | high    | 74%  |

+----------+---------+------+

6 rows in set (0.00 sec)



mysql> CREATE TABLE `mst_class` (

​    ->   `class_id` varchar(255) NOT NULL,

​    ->   `grade` varchar(255) DEFAULT NULL,

​    ->   `rate` varchar(255) DEFAULT NULL

​    -> ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

ERROR 1050 (42S01): Table 'mst_class' already exists

mysql> INSERT INTO `mst_class` VALUES ('abc123', 'primary', '70%');

Query OK, 1 row affected (0.01 sec)



mysql> INSERT INTO `mst_class` VALUES ('abc123', 'middle', '65%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('abc123', 'high', '72%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('hjkk86', 'primary', '69%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('hjkk86', 'middle', '63%');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_class` VALUES ('hjkk86', 'high', '74%');

Query OK, 1 row affected (0.00 sec)



mysql> select * from mst_class;

+----------+---------+------+

| class_id | grade   | rate |

+----------+---------+------+

| abc123   | primary | 70%  |

| abc123   | middle  | 65%  |

| abc123   | high    | 72%  |

| hjkk86   | primary | 69%  |

| hjkk86   | middle  | 63%  |

| hjkk86   | high    | 74%  |

| abc123   | primary | 70%  |

| abc123   | middle  | 65%  |

| abc123   | high    | 72%  |

| hjkk86   | primary | 69%  |

| hjkk86   | middle  | 63%  |

| hjkk86   | high    | 74%  |

+----------+---------+------+

12 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 'primary',

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 'middle',

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 'high'

​    -> from mst_class group by class_id;

+----------+---------+--------+------+

| class_id | primary | middle | high |

+----------+---------+--------+------+

| abc123   | 70%     | 65%    | 72%  |

| hjkk86   | 69%     | 63%    | 74%  |

+----------+---------+--------+------+

2 rows in set (0.00 sec)



mysql> select class_id

​    -> from mst_class group by class_id;

+----------+

| class_id |

+----------+

| abc123   |

| hjkk86   |

+----------+

2 rows in set (0.00 sec)



mysql> select class_id,max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END)

​    -> from mst_class group by class_id;

+----------+--------------------------------------------------------+

| class_id | max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) |

+----------+--------------------------------------------------------+

| abc123   | 70%                                                    |

| hjkk86   | 69%                                                    |

+----------+--------------------------------------------------------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 小学

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高学

​    -> 

​    -> from mst_class group by class_id;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学

max(CASE  WHEN g' at line 3

mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 小学,

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 70%    | 65%    | 72%    |

| hjkk86   | 69%    | 63%    | 74%    |

+----------+--------+--------+--------+

2 rows in set (0.01 sec)



mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 小学,

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中hh

​    -> from mst_class group by class_id;

+----------+--------+--------+----------+

| class_id | 小学   | 中学   | 高中hh   |

+----------+--------+--------+----------+

| abc123   | 70%    | 65%    | 72%      |

| hjkk86   | 69%    | 63%    | 74%      |

+----------+--------+--------+----------+

2 rows in set (0.00 sec)



mysql> 

mysql> select class_id,

​    -> min(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 'primary',

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 'middle',

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 'high'

​    -> from mst_class group by class_id;

+----------+---------+--------+------+

| class_id | primary | middle | high |

+----------+---------+--------+------+

| abc123   | 0       | 65%    | 72%  |

| hjkk86   | 0       | 63%    | 74%  |

+----------+---------+--------+------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> min(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 'primary',

​    -> min(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 'middle',

​    -> min(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 'high'

​    -> from mst_class group by class_id;

+----------+---------+--------+------+

| class_id | primary | middle | high |

+----------+---------+--------+------+

| abc123   | 0       | 0      | 0    |

| hjkk86   | 0       | 0      | 0    |

+----------+---------+--------+------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> (CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 'primary',

​    -> (CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 'middle',

​    -> (CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 'high'

​    -> from mst_class group by class_id;

ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'pyxm2.mst_class.grade' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by

mysql> select class_id,

​    -> (CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 小学,

​    -> (CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> (CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中hh

​    -> from mst_class group by class_id;

ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'pyxm2.mst_class.grade' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by

mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate ,0)) as x

​    -> from mst_class group by class_id;

+----------+------+

| class_id | x    |

+----------+------+

| abc123   | 70%  |

| hjkk86   | 69%  |

+----------+------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate ,0)) as 小学,

​    -> max(if(grade = 'primary' ,rate ,0)) as 中学,

​    -> max(if(grade = 'primary' ,rate ,0)) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 70%    | 70%    | 70%    |

| hjkk86   | 69%    | 69%    | 69%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate )) as 小学,

​    -> max(if(grade = 'primary' ,rate ,0)) as 中学,

​    -> max(if(grade = 'primary' ,rate ,0)) as 高中

​    -> from mst_class group by class_id;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')) as 小学,

max(if(grade = 'primary' ,rate ,0)) as 中学,

max(if(grade = 'pri' at line 2

mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate ,0)) as 小学,

​    -> min(if(grade = 'primary' ,0 ,rate)) as 中学,

​    -> max(if(grade = 'primary' ,rate ,0)) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 70%    | 0      | 70%    |

| hjkk86   | 69%    | 0      | 69%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate ,0)) as 小学,

​    -> max(if(grade = 'primary' ,0 ,rate)) as 中学,

​    -> max(if(grade = 'primary' ,rate ,0)) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 70%    | 72%    | 70%    |

| hjkk86   | 69%    | 74%    | 69%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate ,0)) as 小学,

​    -> max(if(grade = 'middle' ,0 ,rate)) as 中学,

​    -> max(if(grade = 'high' ,rate ,0)) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 70%    | 72%    | 72%    |

| hjkk86   | 69%    | 74%    | 74%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(if(grade = 'primary' ,rate ,0)) as 小学,

​    -> max(if(grade = 'middle' ,rate,0)) as 中学,

​    -> max(if(grade = 'high' ,rate ,0)) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 70%    | 65%    | 72%    |

| hjkk86   | 69%    | 63%    | 74%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> elect class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN 0 ELSE rate END) as 小学,

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中hh

​    -> from mst_class group by class_id;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'elect class_id,

max(CASE  WHEN grade = 'primary' THEN 0 ELSE rate END) as 小学' at line 1

mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN 0 ELSE rate END) as 小学,

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | 72%    | 65%    | 72%    |

| hjkk86   | 74%    | 63%    | 74%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN 'hah' ELSE rate END) as 小学,

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+

| class_id | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+

| abc123   | hah    | 65%    | 72%    |

| hjkk86   | hah    | 63%    | 74%    |

+----------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> select class_id,

​    -> max(CASE  WHEN grade = 'primary' THEN 'hah' ELSE rate END) as 小学,

​    -> max(CASE  WHEN grade = 'primary' THEN 0 ELSE rate END) as 小学,

​    -> max(CASE  WHEN grade = 'primary' THEN rate ELSE 0 END) as 小学,

​    -> max(CASE  WHEN grade = 'middle' THEN rate ELSE 0 END) as 中学,

​    -> max(CASE  WHEN grade = 'high' THEN rate ELSE 0 END) as 高中

​    -> from mst_class group by class_id;

+----------+--------+--------+--------+--------+--------+

| class_id | 小学   | 小学   | 小学   | 中学   | 高中   |

+----------+--------+--------+--------+--------+--------+

| abc123   | hah    | 72%    | 70%    | 65%    | 72%    |

| hjkk86   | hah    | 74%    | 69%    | 63%    | 74%    |

+----------+--------+--------+--------+--------+--------+

2 rows in set (0.00 sec)



mysql> CREATE TABLE `mst_year` ( 

​    ->     `year` int,`month` int,`amount` float 

​    -> ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

Query OK, 0 rows affected (0.01 sec)



mysql> INSERT INTO `mst_year` VALUES (1991, 1, 1);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1991, 2, 2);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1991, 3, 3);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1991, 4, 4);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1992, 1, 1);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1992, 2, 2);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1992, 3, 3);

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_year` VALUES (1992, 4, 4);

Query OK, 1 row affected (0.00 sec)



mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> select * from mst_yrar;

ERROR 1146 (42S02): Table 'pyxm2.mst_yrar' doesn't exist

mysql> select * from mst_yrar;

ERROR 1146 (42S02): Table 'pyxm2.mst_yrar' doesn't exist

mysql> select year,

​    -> sum(CASE  WHEN month = 1 THEN round(amount,1) ELSE 0 END) as 'm1',

​    -> sum(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  2.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  2.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> from mst_year group by year;                                                                             ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from mst_year group by year' at line 1

mysql> select * from mst_year;

+------+-------+--------+

| year | month | amount |

+------+-------+--------+

| 1991 |     1 |      1 |

| 1991 |     2 |      2 |

| 1991 |     3 |      3 |

| 1991 |     4 |      4 |

| 1992 |     1 |      1 |

| 1992 |     2 |      2 |

| 1992 |     3 |      3 |

| 1992 |     4 |      4 |

+------+-------+--------+

8 rows in set (0.00 sec)



mysql> select year from mst_year group by year;

+------+

| year |

+------+

| 1991 |

| 1992 |

+------+

2 rows in set (0.00 sec)



mysql> select year ,

​    -> sum(if(moth = 1,amount,0))as 1月,

​    -> sum(if(moth = 2,amount,0))as 2月,

​    -> sum(if(moth = 3,amount,0))as 3月,

​    -> sum(if(moth = 4,amount,0))as 4月

​    -> 

​    -> 

​    -> from mst_year group by year;

ERROR 1054 (42S22): Unknown column 'moth' in 'field list'

mysql> 

mysql> 

mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> 

​    -> 

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+

| 1991 |    1 |    2 |    3 |    4 |

| 1992 |    1 |    2 |    3 |    4 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,hah,amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

ERROR 1054 (42S22): Unknown column 'hah' in 'field list'

mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hah",amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

+------+------+------+------+------+------+------+

| year | 1月  | 1月  | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+------+------+

| 1991 |    1 |    9 |    9 |    2 |    3 |    4 |

| 1992 |    1 |    9 |    9 |    2 |    3 |    4 |

+------+------+------+------+------+------+------+

2 rows in set, 2 warnings (0.01 sec)



mysql> 

mysql> select year,

​    -> max(CASE  WHEN month = 1 THEN round(amount,1) ELSE 0 END) as 'm1',

​    -> sum(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  2.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  2.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.01 sec)



mysql> select year,

​    -> sum(CASE  WHEN month = 1 THEN round(amount,1) ELSE 0 END) as 'm1',

​    -> sum(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  2.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  2.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hah",amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

+------+------+------+------+------+------+------+

| year | 1月  | 1月  | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+------+------+

| 1991 |    1 |    9 |    9 |    2 |    3 |    4 |

| 1992 |    1 |    9 |    9 |    2 |    3 |    4 |

+------+------+------+------+------+------+------+

2 rows in set, 2 warnings (0.00 sec)



mysql> select year,

​    -> max(CASE  WHEN month = 1 THEN round(amount,1) ELSE 0 END) as 'm1',

​    -> min(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  0.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  0.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> select year,

​    -> sum(CASE  WHEN month = 1 THEN round(amount,1) ELSE 0 END) as 'm1',

​    -> sum(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  2.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  2.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> 

mysql> select year,

​    -> max(CASE  WHEN month = 1 THEN round(amount,1) END) as 'm1',

​    -> min(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  0.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  0.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> select year ,

​    -> sum(if(month = 1,amount))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hah",amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '))as 1月,

sum(if(month = 1,0,amount))as 1月,

sum(if(month = 1,"hah",amount))as' at line 2

mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,amount,null))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hah",amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

+------+------+------+------+------+------+------+------+

| year | 1月  | 1月  | 1月  | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+------+------+------+

| 1991 |    1 |    1 |    9 |    9 |    2 |    3 |    4 |

| 1992 |    1 |    1 |    9 |    9 |    2 |    3 |    4 |

+------+------+------+------+------+------+------+------+

2 rows in set, 2 warnings (0.00 sec)



mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,amount,null))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hah",amount))as 1月,

​    -> sum(if(month = 1,null,amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

+------+------+------+------+------+------+------+------+------+

| year | 1月  | 1月  | 1月  | 1月  | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+------+------+------+------+

| 1991 |    1 |    1 |    9 |    9 |    9 |    2 |    3 |    4 |

| 1992 |    1 |    1 |    9 |    9 |    9 |    2 |    3 |    4 |

+------+------+------+------+------+------+------+------+------+

2 rows in set, 2 warnings (0.00 sec)



mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,amount,null))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hahhhh",amount))as 1月,

​    -> sum(if(month = 1,null,amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

+------+------+------+------+------+------+------+------+------+

| year | 1月  | 1月  | 1月  | 1月  | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+------+------+------+------+

| 1991 |    1 |    1 |    9 |    9 |    9 |    2 |    3 |    4 |

| 1992 |    1 |    1 |    9 |    9 |    9 |    2 |    3 |    4 |

+------+------+------+------+------+------+------+------+------+

2 rows in set, 2 warnings (0.00 sec)



mysql> select year ,

​    -> sum(if(month = 1,amount,0))as 1月,

​    -> sum(if(month = 1,amount,null))as 1月,

​    -> sum(if(month = 1,0,amount))as 1月,

​    -> sum(if(month = 1,"hahhhh",amount))as 1月,

​    -> sum(if(month = 1,null,amount))as 1月,

​    -> sum(if(month = 2,amount,0))as 2月,

​    -> sum(if(month = 3,amount,0))as 3月,

​    -> sum(if(month = 4,amount,0))as 4月

​    -> from mst_year group by year;

+------+------+------+------+------+------+------+------+------+

| year | 1月  | 1月  | 1月  | 1月  | 1月  | 2月  | 3月  | 4月  |

+------+------+------+------+------+------+------+------+------+

| 1991 |    1 |    1 |    9 |    9 |    9 |    2 |    3 |    4 |

| 1992 |    1 |    1 |    9 |    9 |    9 |    2 |    3 |    4 |

+------+------+------+------+------+------+------+------+------+

2 rows in set, 2 warnings (0.00 sec)



mysql> 

mysql> select year,

​    -> max(CASE  WHEN month = 1 THEN round(amount,1) END) as 'm1',

​    -> min(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  0.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  0.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> 

mysql> select year,

​    -> sum(CASE  WHEN month = 1 THEN round(amount,1) ELSE 0 END) as 'm1',

​    -> sum(CASE  WHEN month = 2 THEN round(amount,1) ELSE 0 END) as 'm2',

​    -> sum(CASE  WHEN month = 3 THEN round(amount,1) ELSE 0 END) as 'm3',

​    -> sum(CASE  WHEN month = 4 THEN round(amount,1) ELSE 0 END) as 'm4'

​    -> from mst_year group by year;

+------+------+------+------+------+

| year | m1   | m2   | m3   | m4   |

+------+------+------+------+------+

| 1991 |  1.0 |  2.0 |  3.0 |  4.0 |

| 1992 |  1.0 |  2.0 |  3.0 |  4.0 |

+------+------+------+------+------+

2 rows in set (0.00 sec)



mysql> CREATE TABLE `mst_a` (  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> INSERT INTO `mst_a` VALUES ('A', 'aaa');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('B', 'bbb');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('C', 'ccc');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> CREATE TABLE `mst_b` (  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> INSERT INTO `mst_a` VALUES ('D', 'ddd');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('E', 'eee');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('A', 'abc');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> CREATE TABLE `mst_a` (  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> INSERT INTO `mst_a` VALUES ('A', 'aaa');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('B', 'bbb');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('C', 'ccc');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> CREATE TABLE `mst_b` (  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> INSERT INTO `mst_a` VALUES ('D', 'ddd');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('E', 'eee');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('A', 'abc');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> CREATE TABLE `mst_a` (  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> CREATE TABLE `mst_a`(  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> CREATE TABLE `mst_a`(  `key` varchar,`value` varchar);

ERROR 2006 (HY000): MySQL server has gone away

No connection. Trying to reconnect...

Connection id:    10

Current database: pyxm2



ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> 

mysql> 

mysql> INSERT INTO `mst_a` VALUES ('A', 'aaa');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('B', 'bbb');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('C', 'ccc');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> 

mysql> 

mysql> 

mysql> CREATE TABLE `mst_b` (  `key` varchar,`value` varchar);

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',`value` varchar)' at line 1

mysql> 

mysql> INSERT INTO `mst_a` VALUES ('D', 'ddd');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('E', 'eee');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> INSERT INTO `mst_a` VALUES ('A', 'abc');

ERROR 1146 (42S02): Table 'pyxm2.mst_a' doesn't exist

mysql> CREATE TABLE `mst_a`(  `key` varchar(10),`value` varchar(10));

Query OK, 0 rows affected (0.01 sec)



mysql> 

mysql> 

mysql> INSERT INTO `mst_a` VALUES ('A', 'aaa');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_a` VALUES ('B', 'bbb');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_a` VALUES ('C', 'ccc');

Query OK, 1 row affected (0.00 sec)



mysql> 

mysql> 

mysql> 

mysql> CREATE TABLE `mst_b` (  `key` varchar(10),`value` varchar(10));

Query OK, 0 rows affected (0.01 sec)



mysql> 

mysql> INSERT INTO `mst_a` VALUES ('D', 'ddd');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_a` VALUES ('E', 'eee');

Query OK, 1 row affected (0.00 sec)



mysql> INSERT INTO `mst_a` VALUES ('D', 'ddd');

Query OK, 1 row affected (0.00 sec)



mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> select * from mst_a;

+------+-------+

| key  | value |

+------+-------+

| A    | aaa   |

| B    | bbb   |

| C    | ccc   |

| D    | ddd   |

| E    | eee   |

| D    | ddd   |

+------+-------+

6 rows in set (0.00 sec)



mysql> select * from mst_b;

Empty set (0.00 sec)



mysql> CREATE TABLE `mst_teacher` (

​    ->   `Tid` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `Tname` varchar(10)

​    ->   );

Query OK, 0 rows affected (0.00 sec)



mysql> insert into mst_teacher VALUES(1,'张三老师'),(2,'李四老师'),(3,'王五老师');

Query OK, 3 rows affected (0.01 sec)

Records: 3  Duplicates: 0  Warnings: 0



mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> select * from mst_teacher

​    -> ;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

|   2 | 李四老师     |

|   3 | 王五老师     |

+-----+--------------+

3 rows in set (0.00 sec)



mysql> CREATE TABLE `mst_cla` (

​    ->   `Cid` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `Cname` varchar(10)

​    ->   );

Query OK, 0 rows affected (0.01 sec)



mysql> insert into mst_cla VALUES(1,'1班'),(2,'2班'),(3,'3班');

Query OK, 3 rows affected (0.00 sec)

Records: 3  Duplicates: 0  Warnings: 0



mysql> 

mysql> 

mysql> 

mysql> CREATE TABLE `mst_tc` (

​    ->   `pid` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `Tid` int,`Cid` int 

​    ->   );

Query OK, 0 rows affected (0.00 sec)



mysql> insert into mst_tc VALUES

​    ->     (1,1,1),(2,2,1),(3,3,1),(4,1,2),(5,2,2),(6,3,2),(7,1,3),(8,2,3),(9,3,3);

Query OK, 9 rows affected (0.00 sec)

Records: 9  Duplicates: 0  Warnings: 0



mysql> 

mysql> 

mysql> 

mysql> CREATE TABLE `mst_St` (

​    ->   `SId` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `Sname` varchar(20),`Cid` int 

​    ->   );

Query OK, 0 rows affected (0.00 sec)



mysql> insert into mst_St VALUES(1,'赵雷',1),(2,'钱电',1),(3,'孙风',1),(4,'李云',2),(5,'周梅',2),(6,'吴兰',3),(7,'郑竹',3);

Query OK, 7 rows affected (0.00 sec)

Records: 7  Duplicates: 0  Warnings: 0



mysql> 

mysql> CREATE TABLE `mst_ks` (

​    ->   `Kid` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `Kname` varchar(20),`Pid` int ,`Tid` int 

​    ->   );

Query OK, 0 rows affected (0.00 sec)



mysql> insert into mst_ks VALUES(1,'校长室',0,1),(2,'教务处',1,1),(3,'教学处',1,2),(4,'语文',3,1),(5,'数学',3,2),(6,'英语',3,3);

Query OK, 6 rows affected (0.00 sec)

Records: 6  Duplicates: 0  Warnings: 0



mysql> 

mysql> 

mysql> 

mysql> select * from mst_st;

+-----+--------+------+

| SId | Sname  | Cid  |

+-----+--------+------+

|   1 | 赵雷   |    1 |

|   2 | 钱电   |    1 |

|   3 | 孙风   |    1 |

|   4 | 李云   |    2 |

|   5 | 周梅   |    2 |

|   6 | 吴兰   |    3 |

|   7 | 郑竹   |    3 |

+-----+--------+------+

7 rows in set (0.00 sec)



mysql> select * from mst_st,mst_ts;

ERROR 1146 (42S02): Table 'pyxm2.mst_ts' doesn't exist

mysql> select * from mst_st or mst_ts;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'or mst_ts' at line 1

mysql> +-----+-----------+------+------+

​    -> CREATE TABLE `mst_ks` (

​    ->   `Kid` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `Kname` varchar(20),`Pid` int ,`Tid` int 

​    ->   );

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '+-----+-----------+------+------+

CREATE TABLE `mst_ks` (

  `Kid` int PRIMARY KE' at line 1

mysql> insert into mst_ks VALUES(1,'校长室',0,1),(2,'教务处',1,1),(3,'教学处',1,2),(4,'语文',3,1),(5,'数学',3,2),(6,'英语',3,3);

ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY'

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> select tables;

ERROR 1054 (42S22): Unknown column 'tables' in 'field list'

mysql> 

mysql> 

mysql> 

mysql> 

mysql> show database;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'database' at line 1

mysql> select * from mst_st;

+-----+--------+------+

| SId | Sname  | Cid  |

+-----+--------+------+

|   1 | 赵雷   |    1 |

|   2 | 钱电   |    1 |

|   3 | 孙风   |    1 |

|   4 | 李云   |    2 |

|   5 | 周梅   |    2 |

|   6 | 吴兰   |    3 |

|   7 | 郑竹   |    3 |

+-----+--------+------+

7 rows in set (0.00 sec)



mysql> select * from mst_tc;

+-----+------+------+

| pid | Tid  | Cid  |

+-----+------+------+

|   1 |    1 |    1 |

|   2 |    2 |    1 |

|   3 |    3 |    1 |

|   4 |    1 |    2 |

|   5 |    2 |    2 |

|   6 |    3 |    2 |

|   7 |    1 |    3 |

|   8 |    2 |    3 |

|   9 |    3 |    3 |

+-----+------+------+

9 rows in set (0.00 sec)



mysql> select * from mst_ks;

+-----+-----------+------+------+

| Kid | Kname     | Pid  | Tid  |

+-----+-----------+------+------+

|   1 | 校长室    |    0 |    1 |

|   2 | 教务处    |    1 |    1 |

|   3 | 教学处    |    1 |    2 |

|   4 | 语文      |    3 |    1 |

|   5 | 数学      |    3 |    2 |

|   6 | 英语      |    3 |    3 |

+-----+-----------+------+------+

6 rows in set (0.00 sec)



mysql> select * from mst_cla;

+-----+-------+

| Cid | Cname |

+-----+-------+

|   1 | 1班   |

|   2 | 2班   |

|   3 | 3班   |

+-----+-------+

3 rows in set (0.00 sec)



mysql> select * from mst_teacher;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

|   2 | 李四老师     |

|   3 | 王五老师     |

+-----+--------------+

3 rows in set (0.00 sec)



mysql> select * from mst_teacher limit1;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

|   2 | 李四老师     |

|   3 | 王五老师     |

+-----+--------------+

3 rows in set (0.00 sec)



mysql> select * from mst_teacher limit 1;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

+-----+--------------+

1 row in set (0.00 sec)



mysql> select * from mst_teacher limit2;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

|   2 | 李四老师     |

|   3 | 王五老师     |

+-----+--------------+

3 rows in set (0.00 sec)



mysql> select * from mst_teacher limit 2;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

|   2 | 李四老师     |

+-----+--------------+

2 rows in set (0.00 sec)



mysql> select * from mst_teacher limit 2 order by desc;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order by desc' at line 1

mysql> select * from mst_teacher limit 2 order by tid  desc;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order by tid  desc' at line 1

mysql> select * from mst_teacher  order by tid  desc;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   3 | 王五老师     |

|   2 | 李四老师     |

|   1 | 张三老师     |

+-----+--------------+

3 rows in set (0.00 sec)



mysql> select * from mst_teacher  order by tid  desc limit2;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'limit2' at line 1

mysql> select * from mst_teacher  order by tid  desc limit 2;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   3 | 王五老师     |

|   2 | 李四老师     |

+-----+--------------+

2 rows in set (0.00 sec)



mysql> select * from mst_teacher group by tid order by tid  desc limit 2;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   3 | 王五老师     |

|   2 | 李四老师     |

+-----+--------------+

2 rows in set (0.00 sec)



mysql> select * from mst_teacher group by tid ;

+-----+--------------+

| Tid | Tname        |

+-----+--------------+

|   1 | 张三老师     |

|   2 | 李四老师     |

|   3 | 王五老师     |

+-----+--------------+

3 rows in set (0.00 sec)



mysql> select * from mst_teacher group by tname ;

ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'pyxm2.mst_teacher.Tid' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> 

mysql> create table `mst_Orderinfo`(`CustomerID` char(5),`OrderID` int PRIMARY KEY AUTO_INCREMENT,`Sales` int,`Quantity` int,`OrderDate` date);

Query OK, 0 rows affected (0.01 sec)



mysql> insert INTO mst_Orderinfo VALUES

​    ->     ('A',01,100,1,'2017-03-01'),

​    ->     ('A',02,420,3,'2017-03-15'),

​    ->     ('B',03,300,4,'2017-03-02'),

​    ->     ('B',04,1000,1,'2017-04-01'),

​    ->     ('C',05,500,3,'2017-05-03'),

​    ->     ('C',06,200,1,'2017-05-04');

Query OK, 6 rows affected (0.00 sec)

Records: 6  Duplicates: 0  Warnings: 0



mysql> select * from orderinfo ;

ERROR 1146 (42S02): Table 'pyxm2.orderinfo' doesn't exist

mysql> select * from orderinfo;

ERROR 1146 (42S02): Table 'pyxm2.orderinfo' doesn't exist

mysql> select * from mst_orderinfo;

+------------+---------+-------+----------+------------+

| CustomerID | OrderID | Sales | Quantity | OrderDate  |

+------------+---------+-------+----------+------------+

| A          |       1 |   100 |        1 | 2017-03-01 |

| A          |       2 |   420 |        3 | 2017-03-15 |

| B          |       3 |   300 |        4 | 2017-03-02 |

| B          |       4 |  1000 |        1 | 2017-04-01 |

| C          |       5 |   500 |        3 | 2017-05-03 |

| C          |       6 |   200 |        1 | 2017-05-04 |

+------------+---------+-------+----------+------------+

6 rows in set (0.00 sec)



mysql> select CustomerID,

​    -> sum(Sales) as '消费金额',

​    -> count(CustomerID) as '消费频次',

​    -> sum(Quantity) as '购买产品数量',

​    -> min(OrderDate) as '第一次购买时间',

​    -> max(OrderDate) as '最后一次购买时间'

​    -> from mst_Orderinfo group by CustomerID;

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

| CustomerID | 消费金额     | 消费频次     | 购买产品数量       | 第一次购买时间        | 最后一次购买时间         |

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

| A          |          520 |            2 |                  4 | 2017-03-01            | 2017-03-15               |

| B          |         1300 |            2 |                  5 | 2017-03-02            | 2017-04-01               |

| C          |          700 |            2 |                  4 | 2017-05-03            | 2017-05-04               |

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

3 rows in set (0.00 sec)



mysql> select CustomerID from mst_Orderinfo  group by CustomerID

​    -> ;

+------------+

| CustomerID |

+------------+

| A          |

| B          |

| C          |

+------------+

3 rows in set (0.00 sec)



mysql> select CustomerID ,

​    -> sum(Sales) 消费金额,

​    -> count(OrderID)  消费频次,

​    -> sum(Quantity) 购买产品数量,

​    -> min(OrderDate) 第一次购买时间,

​    -> max(OrderDate) 最后一次购买时间

​    -> from mst_Orderinfo  group by CustomerID

​    -> ;

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

| CustomerID | 消费金额     | 消费频次     | 购买产品数量       | 第一次购买时间        | 最后一次购买时间         |

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

| A          |          520 |            2 |                  4 | 2017-03-01            | 2017-03-15               |

| B          |         1300 |            2 |                  5 | 2017-03-02            | 2017-04-01               |

| C          |          700 |            2 |                  4 | 2017-05-03            | 2017-05-04               |

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

3 rows in set (0.00 sec)



mysql> select CustomerID ,

​    -> sum(Sales) 消费金额,

​    -> count(OrderID)  消费频次,

​    -> sum(Quantity) 购买产品数量,

​    -> min(OrderDate) 第一次购买时间,

​    -> max(OrderDate) '最后一次购买时间'

​    -> from mst_Orderinfo  group by CustomerID;

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

| CustomerID | 消费金额     | 消费频次     | 购买产品数量       | 第一次购买时间        | 最后一次购买时间         |

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

| A          |          520 |            2 |                  4 | 2017-03-01            | 2017-03-15               |

| B          |         1300 |            2 |                  5 | 2017-03-02            | 2017-04-01               |

| C          |          700 |            2 |                  4 | 2017-05-03            | 2017-05-04               |

+------------+--------------+--------------+--------------------+-----------------------+--------------------------+

3 rows in set (0.00 sec)



mysql> create table `mst_OrderDetail`(

​    ->   `OrderDetailID` int PRIMARY KEY AUTO_INCREMENT,

​    ->   `OrderID` int,`SKU` char(5),`Qutity` int);

Query OK, 0 rows affected (0.01 sec)



mysql> insert into mst_OrderDetail 

​    ->   values(1,1,'SKU1',1),

​    ->   (2,2,'SKU1',2),(3,2,'SKU2',1),(4,3,'SKU2',2),

​    ->   (5,3,'SKU3',2),(6,4,'SKU6',1),(7,5,'SKU4',2);

Query OK, 7 rows affected (0.00 sec)

Records: 7  Duplicates: 0  Warnings: 0



mysql> slect * from mst_orderdetail;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'slect * from mst_orderdetail' at line 1

mysql> select * from mst_orderdetail;

+---------------+---------+------+--------+

| OrderDetailID | OrderID | SKU  | Qutity |

+---------------+---------+------+--------+

|             1 |       1 | SKU1 |      1 |

|             2 |       2 | SKU1 |      2 |

|             3 |       2 | SKU2 |      1 |

|             4 |       3 | SKU2 |      2 |

|             5 |       3 | SKU3 |      2 |

|             6 |       4 | SKU6 |      1 |

|             7 |       5 | SKU4 |      2 |

+---------------+---------+------+--------+

7 rows in set (0.00 sec)



mysql> select * from mst_Orderinfo o1,mst_OrderDetail o2

​    -> where oOrderID = oOrderID;

ERROR 1054 (42S22): Unknown column 'oOrderID' in 'where clause'

mysql> 

mysql> 

mysql> select SKU,count(distinct CustomerID) from mst_Orderinfo o1,mst_OrderDetail o2

​    -> where oOrderID = oOrderID

​    -> group by SKU;

ERROR 1054 (42S22): Unknown column 'oOrderID' in 'where clause'

mysql> 

mysql> -- 计算出每个SKU被多少客户购买了,需要以sku分组,去统计用户id并去重

mysql> 

mysql> ;

ERROR: 

No query specified



mysql> select SKU,count(distinct CustomerID) 

​    -> from mst_Orderinfo o1,mst_OrderDetail o2

​    -> where o1.OrderID = o2.OrderID

​    -> group by SKU;

+------+----------------------------+

| SKU  | count(distinct CustomerID) |

+------+----------------------------+

| SKU1 |                          1 |

| SKU2 |                          2 |

| SKU3 |                          1 |

| SKU4 |                          1 |

| SKU6 |                          1 |

+------+----------------------------+

5 rows in set (0.00 sec)



mysql> select * from mst_Orderinfo o1

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where oSKU in ('SKU1','SKU2');

ERROR 1054 (42S22): Unknown column 'oSKU' in 'where clause'

mysql> select * from mst_Orderinfo.o1

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where oSKU in ('SKU1','SKU2');

ERROR 1049 (42000): Unknown database 'mst_orderinfo'

mysql> select * from mst_Orderinfo o1

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where o1.SKU in ('SKU1','SKU2');

ERROR 1054 (42S22): Unknown column 'o1.SKU' in 'where clause'

mysql> select * from mst_Orderinfo o1

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> ;

+------------+---------+-------+----------+------------+---------------+---------+------+--------+

| CustomerID | OrderID | Sales | Quantity | OrderDate  | OrderDetailID | OrderID | SKU  | Qutity |

+------------+---------+-------+----------+------------+---------------+---------+------+--------+

| A          |       1 |   100 |        1 | 2017-03-01 |             1 |       1 | SKU1 |      1 |

| A          |       2 |   420 |        3 | 2017-03-15 |             2 |       2 | SKU1 |      2 |

| A          |       2 |   420 |        3 | 2017-03-15 |             3 |       2 | SKU2 |      1 |

| B          |       3 |   300 |        4 | 2017-03-02 |             4 |       3 | SKU2 |      2 |

| B          |       3 |   300 |        4 | 2017-03-02 |             5 |       3 | SKU3 |      2 |

| B          |       4 |  1000 |        1 | 2017-04-01 |             6 |       4 | SKU6 |      1 |

| C          |       5 |   500 |        3 | 2017-05-03 |             7 |       5 | SKU4 |      2 |

+------------+---------+-------+----------+------------+---------------+---------+------+--------+

7 rows in set (0.00 sec)



mysql> select * from mst_Orderinfo o1

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where o2.SKU in ('SKU1','SKU2');

+------------+---------+-------+----------+------------+---------------+---------+------+--------+

| CustomerID | OrderID | Sales | Quantity | OrderDate  | OrderDetailID | OrderID | SKU  | Qutity |

+------------+---------+-------+----------+------------+---------------+---------+------+--------+

| A          |       1 |   100 |        1 | 2017-03-01 |             1 |       1 | SKU1 |      1 |

| A          |       2 |   420 |        3 | 2017-03-15 |             2 |       2 | SKU1 |      2 |

| A          |       2 |   420 |        3 | 2017-03-15 |             3 |       2 | SKU2 |      1 |

| B          |       3 |   300 |        4 | 2017-03-02 |             4 |       3 | SKU2 |      2 |

+------------+---------+-------+----------+------------+---------------+---------+------+--------+

4 rows in set (0.00 sec)



mysql> select oCustomerID from mst_Orderinfo o1 

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where o2.SKU in ('SKU1','SKU2')

​    -> GROUP BY o1.CustomerID;

ERROR 1054 (42S22): Unknown column 'oCustomerID' in 'field list'

mysql> select oCustomerID from mst_Orderinfo o1 

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where o2.SKU in ('SKU1','SKU2')

​    -> GROUP BY o2.CustomerID

​    -> ;

ERROR 1054 (42S22): Unknown column 'oCustomerID' in 'field list'

mysql> select oCustomerID from mst_Orderinfo o1 

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where o2.SKU in ('SKU1','SKU2')

​    -> GROUP BY o2.CustomerID

​    -> HAVING COUNT(DISTINCT o2.SKU) = 2

​    -> ;

ERROR 1054 (42S22): Unknown column 'oCustomerID' in 'field list'

mysql> select oCustomerID from mst_Orderinfo o1 

​    -> join mst_OrderDetail o2 on o1.OrderID = o2.OrderID

​    -> where o2.SKU in ('SKU1','SKU2')

​    -> GROUP BY o1.CustomerID

​    -> HAVING COUNT(DISTINCT o2.SKU) = 2;

ERROR 1054 (42S22): Unknown column 'oCustomerID' in 'field list'

mysql> 
```

