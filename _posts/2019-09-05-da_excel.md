---
layout: post
title: "数据分析——excel"
date: 2019-09-05
tag: 机器学习machineLearning
---













Excel 操作-学习之道

```
数据分析  
[数] data analysis
[数] analysis of data
```



## 一、基础篇

**1. Excel 2016快速入门**

- **1.1 注册并登录Microsoft账户**

- **1.2 显示比例**

  视图 ----> 显示比例

- **1.3 隐藏网格**

  视图 ----> 去掉勾选网格线



**2. 工作簿基本操作**

- **2.1 保护工作表**

  保护:审阅---->保护工作表---->输入密码---->再次输入密码

  撤销:审阅---->撤销工作表保护---->输入密码

  保护工作表字段内容不能被修改

- **2.2 保护工作薄**

  保护:审阅---->保护工作簿---->输入密码

  撤销:审阅---->保护工作簿---->输入密码

  保护工作簿不能删除移动复制操作

- **2.3 加密工作簿**

  保护:文件---->信息---->保护工作薄---->用密码进行加密---->输入密码---->确认输入密码

  撤销:文件---->信息---->保护工作薄---->删除密码

- **2.4 新建窗口**

  视图---->新建窗口

- **2.5 并排查看两份数据**

  视图---->并排查看

- **2.6 拆分窗口**

  视图---->拆分,即可上下左右拖动混动条查看内容

  注意:恢复的话在点击一次拆分即可

- **2.7 设置自动保存时间间隔**

  文件---->选项---->保存---->保存自动回复信息时间间隔(填入时间)



**3. 数据录入与编辑**

- **3.1 插入行和列**

  开始---->插入---->插入工作表行

  开始---->插入---->插入工作表列

- **3.2 移动行和列**

  1. 拖住想要移动的单元格直接拖拽到想要移动的位置
  2. 剪贴 复制 粘贴

- **3.3 删除行和列**

  单击字母轴或者数字轴,选中右键删除即可

  多选的话,按下Ctrl或者Shift

- **3.4 调整行高和列高**

  单击字母轴或者数字轴,选中后鼠标放置边界线后开始拖拽宽高

- **3.5 显示与隐藏行与列**

  开始---->格式---->隐藏和取消隐藏---->(选中要操作的功能即可)

  或者右键选择隐藏和取消隐藏即可

  取消隐藏选中隐藏行/列的前后,点击取消隐藏

- **3.6 插入单元格或区域**

  (鼠标选定区域)---->开始---->插入---->插入单元格---->(选择需要操作的功能)

- **3.7 删除单元格或区域**

  (鼠标选定区域)---->开始---->删除---->删除单元格---->(选择需要操作的功能)

- **3.8 复制和移动单元格或区域**

  复制:(鼠标选定区域)---->开始---->复制---->(鼠标选定区域)---->粘贴

  移动:选中需要拖动的单元格或区域,鼠标放置边线变成十字箭头,即可拖到到指定位置即可

- **3.9 合并单元格**

  (鼠标选定区域)---->开始---->合并并居中(或者右侧的下拉菜单里面选择其他合并功能)

- **3.10 输入时期和时间**

  选中输入文本单元格,日期时间格式为 XX(年)-XX-(月)-XX(日)  XX(时):XX(分)

  例如: 2019-4-1 12:30

- **3.11 填充单元格或者区域**

  鼠标移至右下角,变成十字,下拉单元格,即可填充(在下拉完成后右下角会有下拉菜单,可以选择其他类型的填充)

- **3.12 查找与替换**

  查找:开始---->查找和选择---->查找(可选择查找下一个和查找全部)

  替换:开始---->查找和选择---->替换(可选择替换下一个和替换全部)

- **3.13 快速插入符号**

  选中单元格区域---->开始---->复制---->选中空白区域---->粘贴下拉菜单---->转置



**4. 设置工作表**

- **4.1 数字日期格式设置**

  开始---->数字(点击下拉菜单)---->选中想要设置的功能选项

- **4.2 设置上标与下标**

  开始---->数字---->常规(下拉框)---->选中文本

  更改文本格式以后

  选中要更改字体的上标文本,点击字体下拉框中单击上标,确定后即可

  下标的操作方法一样



**5. 查阅与打印报表**

- **5.1 在表中添加批注**

  选中需要批注的单元格

  审阅---->新建批注---->输入要批注的文本内容(批注过的数据右上角有红色三角标识,鼠标移入即可显示批注框,也可以在审阅里面点击上一条和下一条内容)

- **5.2 编辑批注内容**

  选中批注的单元格

  1.右键快捷键编辑批注

  2.审阅---->编辑批注

- **5.3 显示隐藏批注**

  选中批注的单元格

  审阅---->显示/隐藏批注|显示所有批注

- **5.4 移动批注或调整批注的大小**

  选中批注框

  移动鼠标光标变成四向时即可拖动批注位置

  移动鼠标光标变成双向即可调整批注宽高

- **5.5 设置批注的格式**

  选中批注框,移动鼠标光标变成四向时,

  右键<设置批注格式>,即可在里面选择对批注内容的设置

- **5.6 更改批注的默认名称**

  文件---->选项---->常规---->对Microsoft Office进行个性化设置---->用户名(设置新的名称)---->再次新建批注即可更改

- **5.7 复制批注**

  复制需要批注的单元格,单击<粘贴>按钮,在下拉选框中选择<选择性粘贴>

  单击<批注>确定即可

- **5.8 删除批注**

  选中需要删除带有批注的单元格

  审阅---->删除

- **5.9 对表进行拼写和语法检查**

  审阅---->校对(拼写检查)---->在里面进行功能选择

- **5.10 设置打印区域**

  选中需要打印的内容单元区域

  页面布局---->打印区域---->设置打印区域

  在文件菜单中选择打印即可

- **5.11 打印标题**

  页面布局---->页面设置---->工作表---->打印标题---->下面点击---->顶端标题行---->旁边的按钮，然后光标选中你需要每页都打印的表头部分，最后确定即可。

- **5.12 设置分页符**

  选中要分页的区域

  页面布局---->分隔符---->插入分页符

- **5.13 选定打印内容**

  打印批注的内容

  页面布局---->打印标题---->注释---->在下拉选框中选择<如同工作表中的显示>确定即可

- **5.14 设置纸张大小**

  视图---->页面布局

  页面布局---->纸张大小---->即可选择

  页面布局---->纸张大小---->(横向/纵向)

- **5.15 设置页边距**

  页面布局---->页边距---->常规

  再次选择<页边距>---->自定义页边距---->设置四个方向的边距,勾选<水平><垂直>确定即可

- **5.16 插入页眉和页脚**

  插入---->页眉和页脚---->页眉---->选择样式

  插入---->页眉和页脚---->页脚---->选择样式

- **5.17 自定义页眉页脚**

  插入---->页眉和页脚---->选中第一个页眉框---->图片(选择图片文件)

  插入---->页眉和页脚---->设置突变格式---->大小---->大小和转角---->高度设置1厘米,确定

  选中第二个页眉框输入标题文本

  选中中间页脚位置插入页码

  选中第三个页脚位置插入时间

- **5.18 打印背景图**

  选中打印区域复制

  打开新工作表

  粘贴里面选择<链接的图片>,再次打开打印即可

- **5.19 只打印工作表的图表**

  点击图表,直接打开打印即可

- **5.20 不打印工作表中的0值**

  选中要打印的工作表区域

  文件---->选项---->高级---->此工作表中的显示选项---->取消勾选<在具有0值的单元格中显示0>确定即可,在返回打印

- **5.21 在同一页面打印不同的区域**

  选中要打印的区域一复制

  打开新工作表,粘贴里面选择<链接的图片>

  再次选中要打印的区域二复制

  打开新工作表,粘贴里面选择<链接的图片>

  在返回打印即可



**6. 数据的保存**

- **6.1 在工作表中插入超链接**

  插入---->链接---->在下方地址栏中输入网址,在<要显示的文字>框中输入在Excel单元格显示的名字,点击<屏幕提示>里面输入鼠标移入显示的名字---->确定即可

- **6.2 将Excel文档保存为PDF文件**

  文件---->导出---->创建PDF/XPS文档---->创建PDF/XPS---->选择路径然后点击<发布>即可

- **6.3 将Excel文档发布为网页**

  文件---->另存为---->浏览---->在保存类型下拉选框中选择<网页(*htm,*html)>点击<发布>---->确定即可



## 二、公式与函数

### 1. 公式应用

- **1.1 在工作表中输入公式**

  选中G2单元格输入公式

  ```
  =C2*D2+E2
  ```

  按Enter,然后使用填充功能填充内容

- **1.2 修改公式**

  直接单击公式单元格,重新选择即可

- **1.3 除了使用<=>开头外的其他输入公式**

  在Excel中只要输入<=>符号,Excel会默认你要输入公式

  也有以 + - 开头的,+代表整数,-代表负数,回车Excel会默认在前面加<=>符号进行运算

- **1.4 通过状态栏进行常规计算**

  在Excel最下方的状态栏右键选择计数平均值求和,当你选中一组数据即可在右下方看到结果

- **1.5 连接到其他工作表中的公式**

  注:这个功能主要应用于同类型的表格对比使用

- **1.6 定义单元格名称**

  公式---->定义的名称---->定义名称---->输入名称和引用位置

- **1.7 将公式定义名称**

  公式---->定义的名称---->定义名称---->输入名称和公式

- **1.8 显示应用中的公式**

  公式---->公式审核(显示公式)

- **1.9 对多个单元格执行相同计算**

  在空白单元格输入一个数字,复制

  选中要运算的多个单元区域,在粘贴选项中选择<选择性粘贴>,在里面选择运算的加减乘除,点击确定,即可完成运算



### 2. 常用函数的使用 

#### 2.1 AVERAGE 函数

**求取一组数字的平均值**

语法:

```
AVERAGE(number1, [number2], ...)
AVERAGE 函数语法具有下列参数：
Number1    必需。 要计算平均值的第一个数字、单元格引用或单元格区域。
Number2, ...    可选。 要计算平均值的其他数字、单元格引用或单元格区域，最多可包含 255 个。
返回参数的平均值（算术平均值）。 例如，如果范围A1:A20 包含数字，则公式 =AVERAGE(A1:A20) 将返回这些数字的平均值。
```

公式---->插入函数---->搜索函数(输入:求平均值,转到)---->选择函数:AVERAGE---->确定

函数参数---->Number1(选择要求平均值的选框)---->确定



#### 2.2 COUNT 函数

**统计参数中包含数字的个数**

公式---->自动求和(下拉选框)---->计数---->选择区域



#### 2.3 MAX 函数

**返回一组数字中的最大值**

公式---->自动求和(下拉选框)---->最大值---->选择区域,回车(Enter)即可



#### 2.4 MIN 函数

**返回一组数字中的最小值**

公式---->自动求和(下拉选框)---->最小值---->选择C2到F15区域,回车(Enter)即可



#### 2.5 IF 函数

**根据指定的条件返回不同的结果**

说明:

```
IF 函数是 Excel 中最常用的函数之一，它可以对值和期待值进行逻辑比较。
因此 IF 语句可能有两个结果。 第一个结果是比较结果为 True，第二个结果是比较结果为 False。
```

函数参数:

```
Logical_test(任何可能被计算为TRUE或FALSE的数值或表达式) 
Value_if_true(是Logical_test为TRUE时的返回值,如果忽略,则返回TRUE.IF函数最多嵌套七层 )  
Value_if_false(是当Logical_test为FALSE时的返回值.如果忽略,则返回FALSE )
```

​	公式---->插入函数---->IF(确定)



#### 2.6 SUMIF 函数

**按给定条件对指定单元格求和**

功能: 可以使用 **SUMIF** 函数对 范围 中符合指定条件的值求和。 

语法

```
SUMIF(range, criteria, [sum_range])
SUMIF 函数语法具有以下参数：
range   必需。 要按条件计算的单元格区域。 每个区域中的单元格都必须是数字, 或者是包含数字的名称、数组或引用。 空白和文本值将被忽略。 所选区域可能包含标准 Excel 格式的日期 (下面的示例)。

criteria查询   必需。 定义哪些单元格将被添加的数字、表达式、单元格引用、文本或函数形式的条件。 例如, 条件可以表示为32、">32"、B5、"32"、"苹果" 或 TODAY ()。
	注意: 任何文本条件或任何含有逻辑或数学符号的条件都必须使用双引号 (") 括起来。 如果条件为数字，则无需使		用双引号。

sum_range   可选。 要添加的实际单元格 (如果要添加的单元格不在range参数中指定的单元格)。 如果省略了sum_range参数, 则 Excel 将添加在range参数中指定的单元格 (与应用条件的单元格相同的单元格)。
可以在 criteria 参数中使用通配符 （包括问号 (?) 和星号 (*)）。 问号匹配任意单个字符；星号匹配任意一串字符。 如果要查找实际的问号或星号，请在该字符前键入波形符 (~)。
```

公式---->数学和三角函数---->在下拉选项里面选择<SUMIF>

函数参数:

```
range 加班记录表!$D$3:$D$28
criteria 部门加班费统计!A3
sum_range 加班记录表!$I$3:$I$28
```



#### 2.7 VLOOKUP 函数

**在区域或数组的列中查找数据**

语法:

```
如果需要在表格或区域中按行查找内容，可使用 VLOOKUP，它是一个查找和引用函数。
=VLOOKUP（要查找的值、要在其中查找值的区域、区域中包含返回值的列号、精确匹配或近似匹配 – 指定为 0/FALSE 或 1/TRUE）。
您需要四条信息才能构建 VLOOKUP 语法：
要查找的值，也被称为查阅值。
查阅值所在的区域。 请记住，查阅值应该始终位于所在区域的第一列，这样 VLOOKUP 才能正常工作。 例如，如果查阅值位于单元格 C2 内，那么您的区域应该以 C 开头。
区域中包含返回值的列号。 例如，如果指定 B2：D11 作为区域，那么应该将 B 算作第一列，C 作为第二列，以此类推。
（可选）如果需要返回值的近似匹配，可以指定 TRUE；如果需要返回值的精确匹配，则指定 FALSE。 如果没有指定任何内容，默认值将始终为 TRUE 或近似匹配。
现在将上述所有内容集中在一起，如下所示：
=VLOOKUP（查阅值、包含查阅值的区域、区域中包含返回值的列号以及（可选）为近似匹配指定 TRUE 或者为精确匹配指定 FALSE）。
```

公式---->插入函数---->或选择类别里面选择<查找与引用>----->选择VLOOKUP函数确定

函数参数:

```
Lookup_value:C3  以这个单元格为中心求值

Table_array:Sheet1!B2:G15  选中销售业绩表中的销售信息

Col_index_num: 2  

Range_lookup:FALSE  (FALSE:代表全部查找精准查找,TRUE代表部分查找,一般情况下选择FALSE)
```



#### 2.8 ROUND 函数

用法:ROUND(求值的单元格,保留几位小数)



#### 2.9 公式与函数混合



#### 2.10 嵌套函数

评定结果字段,需求为全年汇总大于30000为优,大于20000为良,否则为差

插入IF函数

```
Logical_test(SUM(C2:F2)>30000) 

Value_if_true("优")

Value_if_false(IF(SUM(C2:F2)>20000,"良","差"))
```



### 3. 文本函数

#### 3.1 EXACT 函数

**比较两个字符串是否相同**

用法:EXACT(值1单元格,值二单元格)



#### 3.2 LEN 函数

**计算文本中的字符个数**

语法格式=Len( text)



#### 3.3 REPT 函数

**按给定次数重复文本**

语法: REPT(text, number_times)

函数语参数：

```
Text   必需。 需要重复显示的文本。

Number_times   必需。 用于指定文本重复次数的正数。
```



#### 3.4 FIXED 函数

**将数字按指定的小数位数取整**

语法

```
FIXED(number, [decimals], [no_commas])
FIXED 函数语法具有下列参数：
- Number    必需。 要进行舍入并转换为文本的数字。
- decimals    可选。 小数点右边的位数。
- no_commas    可选。 一个逻辑值，如果为 TRUE，则会禁止 FIXED 在返回的文本中包含逗号。
```



#### 3.5 LEFT 函数

**从文本左侧起提取指定个数的字符**

语法

```
LEFT(text,num_chars)
Text     是包含要提取字符的文本字符串。
Num_chars    指定要由 LEFT 提取的字符数。Num_chars 必须大于或等于零。如果 num_chars 大于文本长度，则 LEFT 返回所有文本。如果省略 num_chars，则假定其值为 1。
```



#### 3.6 MID 函数

**从文本指定位置起提取指定个数的字符**

语法

```python
MID(text, start_num, num_chars)
文本    必需。 包含要提取字符的文本字符串。
start_num    必需。 文本中要提取的第一个字符的位置。 文本中第一个字符的 start_num 为 1，以此类推。
num_chars    必需。 指定希望 MID 从文本中返回字符的个数。
```



#### 3.7 RIGHT 函数

**从文本右侧起提取指定个数的字符**

语法

```
RIGHT(text,[num_chars])
RIGHTB(text,[num_bytes])
文本    必需。 包含要提取字符的文本字符串。
num_chars    可选。 指定希望 RIGHT 提取的字符数。
```



#### 3.8 ASC 函数

**将全角字符转换为半角字符**

语法: ASC(text)

函数参数：

```
Text    必需。文本或对包含要更改文本的单元格的引用。如果文本不包含任何全角字母，则不会对文本进行转换。
```



#### 3.9 RMB 函数

**将数字转换为带人民币符号￥的文本**

语法:

```
RMB(number, [decimals])
number :需要转换的参数
decimals:保留的小数点位数
```



#### 3.10 T 函数

**将参数转换为文本**

语法

```
T(value)
T 函数语法具有下列参数：
- 值    必需。 要测试的值。
```



#### 3.11 LOWER 函数

**将文本转换为小写**

语法

```
LOWER(text)
LOWER 函数语法具有下列参数：
Text    必需。 要转换为小写字母的文本。 LOWER 不改变文本中的非字母字符。
```



#### 3.12 PROPER 函数

**将文本中每个单词的首字母转换为大写**

语法

```
PROPER(text)
PROPER 函数语法具有下列参数：
文本    必需。 用引号括起来的文本、返回文本值的公式，或者对包含要进行部分大写转换文本的单元格的引用。

```



#### 3.13 FIND 函数

**以字符为单位并区分大小写地查找指定字符的位置**

语法

```
FIND(find_text, within_text, [start_num])
find_text    必需。 要查找的文本。
within_text    必需。 包含要查找文本的文本。
start_num    可选。 指定开始进行查找的字符。 within_text 中的首字符是编号为 1 的字符。 如果省略 start_num，则假定其值为 1。

```



#### 3.14 FINDB 函数

**以字节为单位并区分大小写地查找指定字符的位置**

语法

```
FIND(find_text, within_text, [start_num])
FINDB(find_text, within_text, [start_num])
FIND 和 FINDB 函数语法具有下列参数：
find_text    必需。 要查找的文本。
within_text    必需。 包含要查找文本的文本。
start_num    可选。 指定开始进行查找的字符。 within_text 中的首字符是编号为 1 的字符。 如果省略 start_num，则假定其值为 1。
FIND 适用于使用单字节字符集 (SBCS) 的语言，而 FINDB 适用于使用双字节字符集 (DBCS) 的语言。

```



#### 3.15 SEARCH 函数

**以字符为单位查找指定字符的位置**

语法

```
SEARCH(find_text,within_text,[start_num])
SEARCHB(find_text,within_text,[start_num])
SEARCH 和 SEARCHB 函数具有下列参数：
- **find_text**    必需。要查找的文本。
- **within_text**    必需。要在其中搜索 **find_text** 参数的值的文本。
- **start_num**    可选。**within_text** 参数中从之开始搜索的字符编号。

```



#### 3.16 REPLACE 函数

**以字符为单位根据指定位置进行替换**

语法

```
REPLACE(old_text, start_num, num_chars, new_text)
REPLACEB(old_text, start_num, num_bytes, new_text)
REPLACE 和 REPLACEB 函数语法具有下列参数：
- old_text    必需。 要替换其部分字符的文本。
- start_num    必需。 old_text 中要替换为 new_text 的字符位置。
- num_chars    必需。 old_text 中希望 REPLACE 使用 new_text 来进行替换的字符数。
- Num_bytes    必需。old_text 中希望 REPLACEB 使用 new_text 来进行替换的字节数。
- new_text    必需。 将替换 old_text 中字符的文本。
```



### 5. 逻辑函数

#### 5.1 FALSE 函数

**返回逻辑值 FALSE**



#### 5.2 AND 函数

**判断指定的多个条件是否同时成立**

```
它是一个逻辑函数，用于确定测试中的所有条件是否均为 TRUE。
```



#### 5.3 OR 函数

**判断指定的任一条件是为真，即返回真**

语法

```
它是一个逻辑函数，用于确定测试中的所有条件是否均为 TRUE。

```



#### 5.4 NOT 函数

**对逻辑值求反**

语法

```
如果你想确保一个值不等同于另一值，请使用 NOT 函数

```



#### 5.5 IFERROR 函数

**对错误结果进行处理**

语法

```
IFERROR(value, value_if_error)
IFERROR 函数语法具有下列参数：
值    必需。 检查是否存在错误的参数。
Value_if_error    必需。 公式的计算结果错误时返回的值。 计算以下错误类型：#N/A、#VALUE!、#REF!、#DIV/0!、#NUM!、 #NAME? 或 #NULL!。

```



### 6. 日期与时间函数

#### 6.1 TODAY 函数

**返回当前日期**

语法

```
TODAY()
TODAY 函数语法没有参数。
**注意:** Excel 可将日期存储为可用于计算的连续序列号。 默认情况下，1900 年 1 月 1 日的序列号为 1，2008 年 1 月 1 日的序列号为 39,448，这是因为它距 1900 年 1 月 1 日有 39,447 天。
```



#### 6.2 TIME 函数

**返回某一特定时间的小数值**

语法

```
TIME(hour, minute, second)
TIME 函数语法具有下列参数：
小时    必需。 0（零）到 32767 之间的数字，代表小时。 任何大于 23 的值都会除以 24，余数将作为小时值。 例如，TIME(27,0,0) = TIME(3,0,0) = .125 或 3:00 AM。
分钟    必需。 0 到 32767 之间的数字，代表分钟。 任何大于 59 的值将转换为小时和分钟。 例如，TIME(0,750,0) = TIME(12,30,0) = .520833 或 12:30 PM。
秒    必需。 0 到 32767 之间的数字，代表秒。 任何大于 59 的值将转换为小时、分钟和秒。 例如，TIME(0,0,2000) = TIME(0,33,22) = .023148 或 12:33:20 AM
```



#### 6.3 YEAR 函数

**返回某日期对应的年份**

语法

```
YEAR(serial_number)
YEAR 函数语法具有下列参数：
Serial_number    必需。 要查找的年份的日期。 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题。
```



#### 6.4 MONTH 函数

**返回某日期对应的月份**

语法

```
MONTH(serial_number)
MONTH 函数语法具有下列参数：
Serial_number    必需。要查找的月份日期。应使用 DATE 函数输入日期，或将日期作为其他公式或函数的结果输入。例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。如果日期以文本形式输入，则会出现问题。
返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。
```



#### 6.5 DAYS360 函数

**以360天为准计算两个日期间天数**

语法

```
DAYS360(start_date,end_date,[method])
DAYS360 函数语法具有下列参数：
Start_date、end_date    必需。 用于计算期间天数的起止日期。 如果 start_date 在 end_date 之后，则 DAYS360 函数将返回一个负数。 应使用 DATE 函数输入日期，或者将从其他公式或函数派生日期。 例如，使用函数 DATE(2008,5,23) 以返回 2008 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题。
方法    可选。 逻辑值，用于指定在计算中是采用美国方法 还是欧洲方法。
按照一年 360 天的算法（每个月以 30 天计，一年共计 12 个月），DAYS360 函数返回两个日期间相差的天数，这在一些会计计算中将会用到。 如果财会系统是基于一年 12 个月，每月 30 天，可使用此函数帮助计算支付款项。
```



#### 6.6 NETWORKDAYS 函数

**计算日期间所有工作日数**

语法

```
NETWORKDAYS(start_date, end_date, [holidays])
NETWORKDAYS 函数语法具有下列参数：
Start_date    必需。 一个代表开始日期的日期。
End_date    必需。 一个代表终止日期的日期。
Holidays    可选。不在工作日历中的一个或多个日期所构成的可选区域，例如：省/市/自治区和国家/地区的法定假日以及其他非法定假日。该列表可以是包含日期的单元格区域，或是表示日期的序列号的数组常量。
返回参数 start_date 和 end_date 之间完整的工作日数值。 工作日不包括周末和专门指定的假期。 可以使用函数 NETWORKDAYS，根据某一特定时期内雇员的工作天数，计算其应计的报酬。
```



#### 6.7 WORKDAY 函数

**计算指定日期向前或向后数个工作日后的日期**

语法

```
WORKDAY(start_date, days, [holidays])
WORKDAY 函数语法具有下列参数：
Start_date    必需。 一个代表开始日期的日期。
Days    必需。 start_date 之前或之后不含周末及节假日的天数。 Days 为正值将生成未来日期；为负值生成过去日期。
Holidays    可选。一个可选列表，其中包含需要从工作日历中排除的一个或多个日期，例如各种省/市/自治区和国家/地区的法定假日及非法定假日。该列表可以是包含日期的单元格区域，也可以是由代表日期的序列号所构成的数组常量。
重要: 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题。
返回在某日期（起始日期）之前或之后、与该日期相隔指定工作日的某一日期的日期值。 工作日不包括周末和专门指定的假日。 在计算发票到期日、预期交货时间或工作天数时，可以使用函数 WORKDAY 来扣除周末或假日。
```



#### 6.8 YEARFRAC 函数

**计算从开始日期到结束日期所经历的天数占全年天数的**

语法

```
YEARFRAC(start_date, end_date, [basis])
YEARFRAC 函数语法具有下列参数：
Start_date    必需。 一个代表开始日期的日期。
End_date    必需。 一个代表终止日期的日期。
Basis    可选。 要使用的日计数基准类型。
Basis			日计数基准
0 或省略		  US (NASD) 30/360
1				实际/实际
2				实际/360
3				实际/365
4				欧洲 30/36
重要: 
应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2018,5,23) 输入 2018 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题。
如果使用 US (NASD) 30/360 基准，且 start_date 是二月的最后一天，则 YEARFRAC 函数可能会返回错误的结果。
YEARFRAC 可计算两个日期（start_date 和 end_date）之间的天数（取整天数）占一年的比例。 例如，可使用 YEARFRAC 确定某一特定条件下全年效益或债务的比例。
```



### 7. 查找与引用函数

#### 7.1 CHOOSE 函数

**根据序号从列表中选择对应的内容**

语法

```
CHOOSE(index_num, value1, [value2], ...)
CHOOSE 函数语法具有以下参数：
index_num    必需。 用于指定所选定的数值参数。 index_num 必须是介于 1 到 254 之间的数字，或是包含 1 到 254 之间的数字的公式或单元格引用。
如果 index_num 为 1，则 CHOOSE 返回 value1；如果为 2，则 CHOOSE 返回 value2，以此类推。
如果 index_num 小于 1 或大于列表中最后一个值的索引号，则 CHOOSE 返回 #VALUE! 错误值。
如果 index_num 为小数，则在使用前将被截尾取整。
value1, value2, ...    Value1 是必需的，后续值是可选的。 1 到 254 个数值参数，CHOOSE 将根据 index_num 从中选择一个数值或一项要执行的操作。 参数可以是数字、单元格引用、定义的名称、公式、函数或文本
使用 index_num 返回数值参数列表中的数值。 使用 CHOOSE 可以根据索引号从最多 254 个数值中选择一个。 例如，如果 value1 到 value7 表示一周的 7 天，那么将 1 到 7 之间的数字用作 index_num 时，CHOOSE 将返回其中的某一天。

```



#### 7.2 HLOOKUP 函数

**在区域或数组的行中查找数据**

语法

```
HLOOKUP(lookup_value, table_array, row_index_num, [range_lookup])
HLOOKUP 函数语法具有下列参数：
Lookup_value    必需。 要在表格的第一行中查找的值。 Lookup_value 可以是数值、引用或文本字符串。
Table_array    必需。 在其中查找数据的信息表。 使用对区域或区域名称的引用。
Table_array 的第一行的数值可以为文本、数字或逻辑值。
如果 range_lookup 为 TRUE，则 table_array 的第一行的数值必须按升序排列：...-2、-1、0、1、2、...、A-Z、FALSE、TRUE；否则，HLOOKUP 将不能给出正确的数值。 如果 range_lookup 为 FALSE，则 table_array 不必进行排序。
文本不区分大小写。
将数值从左到右按升序排序。有关详细信息，请参阅对区域或表中的数据排序。
Row_index_num    必需。 table_array 中将返回的匹配值的行号。 row_index_num 为 1 时，返回 table_array 的第一行的值；row_index_num 为 2 时，返回 table_array 第二行中的值，依此类推。 如果 row_index_num 小于 1，则 HLOOKUP 返回 错误值 #VALUE!；如果 row_index_num 大于 table_array 的行数，则 HLOOKUP 返回 错误值 #REF!。
Range_lookup    可选。 一个逻辑值，指定希望 HLOOKUP 查找精确匹配值还是近似匹配值。 如果为 TRUE 或省略，则返回近似匹配值。 换言之，如果找不到精确匹配值，则返回小于 lookup_value 的最大值。 如果为 False，则 HLOOKUP 将查找精确匹配值。 如果找不到精确匹配值，则返回错误值 #N/A。

```



#### 7.3 LOOKUP 函数

**以向量形式在单行单列中查找**

语法:

```
LOOKUP(lookup_value, lookup_vector, [result_vector])
LOOKUP 函数向量形式语法具有以下参数：
lookup_value    必需。 LOOKUP 在第一个向量中搜索的值。 Lookup_value 可以是数字、文本、逻辑值、名称或对值的引用。
lookup_vector    必需。 只包含一行或一列的区域。 lookup_vector 中的值可以是文本、数字或逻辑值。
重要: lookup_vector 中的值必须按升序排列：..., -2, -1, 0, 1, 2, ..., A-Z, FALSE, TRUE；否则，LOOKUP 可能无法返回正确的值。 文本不区分大小写。
result_vector    可选。只包含一行或一列的区域。result_vector 参数必须与 lookup_vector 参数大小相同。其大小必须相同。

```



#### 7.4 MATCH 函数

**返回指定内容所在的位置**

语法

```
MATCH(lookup_value, lookup_array, [match_type])
MATCH 函数语法具有下列参数：
lookup_value    必需。 要在 lookup_array 中匹配的值。 例如，如果要在电话簿中查找某人的电话号码，则应该将姓名作为查找值，但实际上需要的是电话号码。
lookup_value 参数可以为值（数字、文本或逻辑值）或对数字、文本或逻辑值的单元格引用。
lookup_array    必需。 要搜索的单元格区域。
match_type    可选。 数字 -1、0 或 1。 match_type 参数指定 Excel 如何将 lookup_value 与 lookup_array 中的值匹配。 此参数的默认值为 1。

```



#### 7.5 TRANSPOSE 函数

**转置数据区域的行列位置**

语法

```
TRANSPOSE(array)
TRANSPOSE 函数语法具有以下参数：
数组   必备.要转置的工作表上的数组或单元格区域。通过使用数组的第一行作为新数组的第一列, 数组的第二行作为新数组的第二列, 依此类推, 创建数组的转置。如果你不确定如何输入数组公式, 请参阅创建数组公式。

```



#### 7.6 INDIRECT 函数

**返回由文本值指定的引用**

语法

```
INDIRECT(ref_text, [a1])
INDIRECT 函数语法具有以下参数：
Ref_text    必需。对单元格的引用，此单元格包含 A1 样式的引用、R1C1 样式的引用、定义为引用的名称或对作为文本字符串的单元格的引用。如果 ref_text 不是合法的单元格引用，则 INDIRECT 返回 错误值。
如果 ref_text 是对另一个工作簿的引用（外部引用），则被引用的工作簿必须已打开。如果源工作簿没有打开，则 INDIRECT 返回错误值 #REF!。
注意    Excel Web App 中不支持外部引用。
如果 ref_text 引用的单元格区域超出 1,048,576 这一行限制或 16,384 (XFD) 这一列限制，则 INDIRECT 返回错误 #REF!。
注意    此行为不同于 Microsoft Office Excel 2007 之前的 Excel 版本，早期的版本会忽略超出的限制并返回一个值。
A1    可选。一个逻辑值，用于指定包含在单元格 ref_text 中的引用的类型。
如果 a1 为 TRUE 或省略，ref_text 被解释为 A1-样式的引用。
如果 a1 为 FALSE，则将 ref_text 解释为 R1C1 样式的引用。
返回由文本字符串指定的引用。此函数立即对引用进行计算，并显示其内容。如果需要更改公式中对单元格的引用，而不更改公式本身，请使用函数 INDIRECT。

```



### 8. 财务函数

#### 8.1 FV 函数

**计算一笔投资的期值**

语法

```
FV(rate,nper,pmt,[pv],[type])
有关函数 FV 中各参数以及年金函数的详细信息，请参阅函数 PV。
FV 函数语法具有下列参数：
Rate    必需。 各期利率。
Nper    必需。年金的付款总期数。
Pmt    必需。 各期所应支付的金额，在整个年金期间保持不变。 通常 pmt 包括本金和利息，但不包括其他费用或税款。 如果省略 pmt，则必须包括 pv 参数。
pv    可选。 现值，或一系列未来付款的当前值的累积和。 如果省略 pv，则假定其值为 0（零），并且必须包括 pmt 参数。
Type    可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。 如果省略 type，则假定其值为 0。
FV 是一个财务函数，用于根据固定利率计算投资的未来值。 可以将 FV 与定期付款、固定付款或一次付清总额付款结合使用。

```



#### 8.2 PV 函数

**计算投资的现值**

语法

```
PV(rate, nper, pmt, [fv], [type])
PV 函数语法具有下列参数：
Rate    必需。 各期利率。 例如，如果您获得年利率为 10% 的汽车贷款，并且每月还款一次，则每月的利率为 10%/12（即 0.83%）。 您需要在公式中输入 10%/12（即 0.83%）或 0.0083 作为利率。
Nper    必需。 年金的付款总期数。 例如，如果您获得为期四年的汽车贷款，每月还款一次，则贷款期数为 4*12（即 48）期。 您需要在公式中输入 48 作为 nper。
Pmt    必需。 每期的付款金额，在年金周期内不能更改。 通常，pmt 包括本金和利息，但不含其他费用或税金。 例如，对于金额为 ￥100,000、利率为 12% 的四年期汽车贷款，每月付款为 ￥2633.30。 您需要在公式中输入 -2633.30 作为 pmt。 如果省略 pmt，则必须包括 fv 参数。
fv    可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（例如，贷款的未来值是 0）。 例如，如果要在 18 年中为支付某个特殊项目而储蓄 ￥500,000，则 ￥500,000 就是未来值。 然后，您可以对利率进行保守的猜测，并确定每月必须储蓄的金额。 如果省略 fv，则必须包括 pmt 参数。
类型    可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。
PV 是一个财务函数，用于根据固定利率计算贷款或投资的现值。 可以将 PV 与定期付款、固定付款（如按揭或其他贷款）或投资目标的未来值结合使用。

```



#### 8.3 RATE 函数

**计算年金的各期利率**

语法

```
RATE(nper, pmt, pv, [fv], [type], [guess])
注意: 有关参数 nper、pmt、pv、fv 和 type 的详细说明，请参阅 PV。
RATE 函数语法具有下列参数：
Nper    必需。年金的付款总期数。
Pmt    必需。 每期的付款金额，在年金周期内不能更改。 通常，pmt 包括本金和利息，但不含其他费用或税金。 如果省略 pmt，则必须包括 fv 参数。
pv    必需。现值即一系列未来付款当前值的总和。
Fv    可选。未来值，或在最后一次付款后希望得到的现金余额。如果省略 fv，则假定其值为 0（例如，贷款的未来值是 0）。如果省略 fv，则必须包括 pmt 参数。
类型    可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。
Guess    可选。 预期利率。
如果省略 guess，则假定其值为 10%。
如果 RATE 不能收敛，请尝试不同的 guess 值。 如果 guess 在 0 和 1 之间，RATE 通常会收敛。

```



#### 8.4 NPER 函数

**计算还款次数**

语法

```
NPER(rate,pmt,pv,[fv],[type])
有关 NPER 中各参数的详细说明及有关年金函数的详细信息，请参阅 PV。
NPER 函数语法具有下列参数：
Rate    必需。 各期利率。
Pmt    必需。 各期所应支付的金额，在整个年金期间保持不变。 通常 pmt 包括本金和利息，但不包括其他费用或税款。
Pv    必需。 现值，或一系列未来付款的当前值的累积和。
Fv    可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（例如，贷款的未来值是 0）。
类型    可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。
基于固定利率及等额分期付款方式，返回某项投资的总期数。
```



#### 8.5 PMT 函数

**计算贷款的每期付款额**

语法

```
PMT(rate, nper, pv, [fv], [type])
注意: 有关 PMT 参数的更完整的说明，请参阅 PV 函数。
PMT 函数语法具有下列参数：
rate    必需。 贷款利率。
Nper    必需。 该项贷款的付款总数。
pv    必需。 现值，或一系列未来付款额现在所值的总额，也叫本金。
fv    可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（零），即贷款的未来值是 0。
类型    可选。 数字 0（零）或 1 指示支付时间。
PMT 是一个财务函数，用于根据固定付款额和固定利率计算贷款的付款额。
```



#### 8.6 IPMT 函数

**计算贷款在给定期间内支付的利息**

语法

```
IPMT(rate, per, nper, pv, [fv], [type])
IPMT 函数语法具有以下参数：
Rate    必需。 各期利率。
Per    必需。 用于计算其利息数额的期数，必须在 1 到 nper 之间。
Nper    必需。年金的付款总期数。
Pv    必需。 现值，或一系列未来付款的当前值的累积和。
Fv    可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（例如，贷款的未来值是 0）。
Type    可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。 如果省略 type，则假定其值为 0。
基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。
```



#### 14.7 PPMT 函数

**计算贷款在给定期间内偿还的本金**

语法

```
PPMT(rate, per, nper, pv, [fv], [type])
注意: 有关 PPMT 中参数的详细说明，请参阅 PV。
PPMT 函数语法具有下列参数：
Rate    必需。 各期利率。
per    必需。 指定期数，该值必须在 1 到 nper 范围内。
Nper    必需。年金的付款总期数。
pv    必需。现值即一系列未来付款当前值的总和。
fv    可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（零），即贷款的未来值是 0。
类型    可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。
返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。
```



#### 8.8 ISPMT 函数

**计算特定投资期内支付的利息**

语法

```
ISPMT(rate, per, nper, pv)
ISPMT 函数语法具有下列参数：
参数			描述
费率			必填。投资利率。
Per			  必填。为其您想要查找感兴趣，并且必须介于 1 到 Nper 之间时间段。
Nper		  必填。投资的付款期总数。
Pv			  必填。投资的现值。对于贷款，Pv 是贷款金额。
计算利率支付 （或接收） 给定期间内的贷款 （或投资） 甚至本金付款。
```



#### 8.9 CUMIPMT 函数

**计算两个付款期之间累积支付的利息**

语法

```
CUMIPMT(rate, nper, pv, start_period, end_period, type)
CUMIPMT 函数语法具有下列参数：
Rate    必需。 利率。
Nper    必需。 总付款期数。
pv    必需。 现值。
Start_period    必需。 计算中的首期。 付款期数从 1 开始计数。
End_period    必需。 计算中的末期。
Type    必需。 付款时间类型。
返回一笔贷款在给定的 start_period 到 end_period 期间累计偿还的利息数额。
```



#### 8.10 CUMPRINC 函数

**计算两个付款期之间累积支付的本金**

语法

```
CUMPRINC(rate, nper, pv, start_period, end_period, type)
CUMPRINC 函数语法具有下列参数：
Rate    必需。 利率。
Nper    必需。 总付款期数。
pv    必需。 现值。
Start_period    必需。 计算中的首期。 付款期数从 1 开始计数。
End_period    必需。 计算中的末期。
Type    必需。 付款时间类型。
返回一笔贷款在给定的 start_period 到 end_period 期间累计偿还的本金数额。

```



#### 8.11 FVSCHEDULE 函数

**使用一系列复利率计算初始本金的未来值**

语法

```
FVSCHEDULE(principal, schedule)
FVSCHEDULE 函数语法具有下列参数：
Principal    必需。 现值。
计划    必需。 要应用的利率数组。
返回应用一系列复利率计算的初始本金的未来值。 使用 FVSCHEDULE 通过变量或可调节利率计算某项投资未来的价值。

```



#### 8.12 NPV 函数

**基于一系列定期的现金流和贴现率，计算投资的净现值**

语法

```
NPV(rate,value1,[value2],...)
NPV 函数语法具有下列参数：
rate    必需。某一期间的贴现率。
value1, value2, ...    Value1 是必需的，后续值是可选的。这些是代表支出及收入的 1 到 254 个参数。
Value1, value2, ...在时间上必须具有相等间隔，并且都发生在期末。
NPV 使用 value1, value2,... 的顺序来说明现金流的顺序。一定要按正确的顺序输入支出值和收益值。
忽略以下类型的参数：参数为空白单元格、逻辑值、数字的文本表示形式、错误值或不能转化为数值的文本。
如果参数是一个数组或引用，则只计算其中的数字。数组或引用中的空白单元格、逻辑值、文本或错误值将被忽略。
使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。

```



#### 8.13 XNPV 函数

**计算一组未必定期发生的现金流的净现值**

语法

```
XNPV(rate, values, dates)
XNPV 函数语法具有下列参数：
Rate    必需。 应用于现金流的贴现率。
值    必需。 与 dates 中的支付时间相对应的一系列现金流。 首期支付是可选的，并与投资开始时的成本或支付有关。 如果第一个值是成本或支付，则它必须是负值。 所有后续支付都基于 365 天/年贴现。 数值系列必须至少要包含一个正数和一个负数。
日期    必需。 与现金流支付相对应的支付日期表。 第一个支付日期代表支付表的开始日期。 其他所有日期应晚于该日期，但可按任何顺序排列。

```



#### 8.14 IRR 函数

**计算一系列现金流的内部收益率**

语法

```
IRR(values, [guess])
IRR 函数语法具有下列参数：
Values    必需。 数组或单元格的引用，这些单元格包含用来计算内部收益率的数字。
Values 必须包含至少一个正值和一个负值，以计算返回的内部收益率。
IRR 使用值的顺序来说明现金流的顺序。 一定要按您需要的顺序输入支出值和收益值。
如果数组或引用包含文本、逻辑值或空白单元格，这些数值将被忽略。
Guess    可选。 对函数 IRR 计算结果的估计值。
Microsoft Excel 使用迭代法计算函数 IRR。 从 guess 开始，IRR 不断修正计算结果，直至其精度小于 0.00001%。 如果 IRR 运算 20 次，仍未找到结果，则返回 错误值 #NUM!。
多数情况下，不必为 IRR 计算提供 guess 值。 如果省略 guess，则假定它为 0.1 (10%)。
如果 IRR 返回 错误值 #NUM!，或结果不接近您预期的值，可用另一个 guess 值重试。
返回由值中的数字表示的一系列现金流的内部收益率。 这些现金流不必等同，因为它们可能作为年金。 但是，现金流必须定期（如每月或每年）出现。 内部收益率是针对包含付款（负值）和收入（正值）的定期投资收到的利率。

```



#### 8.15 MIRR 函数

**计算正负现金流在不同利率下支付的内部收益率**

语法

```
MIRR(values, finance_rate, reinvest_rate)
MIRR 函数语法具有下列参数：
Values    必需。 数组或对包含数字的单元格的引用。 这些数值代表一系列定期支出（负值）和收益（正值）。
值必须包含至少一个正值和一个负值, 以计算修改后的内部收益率。 否则, MIRR 将返回 #DIV/0! 错误值。
如果数组或引用参数包含文本、逻辑值或空白单元格，则这些值将被忽略；但包含零值的单元格将计算在内。
Finance_rate    必需。 现金流中使用的资金支付的利率。
Reinvest_rate    必需。 将现金流再投资的收益率。
返回一系列定期现金流的已修改内部收益率。 MIRR 认为投资的成本和 reinvestment 在现金上收到的利息。

```



#### 8.16 XIRR 函数

**计算一组未必定期发生的现金流的内部收益率**

语法

```
XIRR(values, dates, [guess])
XIRR 函数语法具有下列参数：
值    必需。 与 dates 中的支付时间相对应的一系列现金流。 首期支付是可选的，并与投资开始时的成本或支付有关。 如果第一个值是成本或支付，则它必须是负值。 所有后续支付都基于 365 天/年贴现。 值系列中必须至少包含一个正值和一个负值。
日期    必需。 与现金流支付相对应的支付日期表。 日期可按任何顺序排列。 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题 。
Guess    可选。 对函数 XIRR 计算结果的估计值。
返回一组不一定定期发生的现金流的内部收益率。 若要计算一组定期现金流的内部收益率，请使用函数 IRR。

```



#### 8.17 AMORDEGRC 函数

**根据资产的耐用年限，计算每个结算期间的折旧值**

语法

```
AMORDEGRC(cost, date_purchased, first_period, salvage, period, rate, [basis])
重要: 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题。
AMORDEGRC 函数语法具有下列参数：
Cost    必需。 资产原值。
Date_purchased    必需。 购入资产的日期。
First_period    必需。 第一个期间结束时的日期。
Salvage    必需。 资产在使用寿命结束时的残值。
Period    必需。 期间。
Rate    必需。 折旧率。
Basis    可选。 要使用的年基准。
返回每个结算期间的折旧值。 该函数主要为法国会计系统提供。 如果某项资产是在该结算期的中期购入的，则按直线折旧法计算。 该函数与函数 AMORLINC 相似，不同之处在于该函数中用于计算的折旧系数取决于资产的寿命。

```



#### 8.18  DB 函数

**使用固定余额递减法，计算一笔资产在给定期间内的折旧值**

语法

```
DB(cost, salvage, life, period, [month])
DB 函数语法具有下列参数：
Cost    必需。 资产原值。
Salvage    必需。 折旧末尾时的值（有时也称为资产残值）。
Life    必需。 资产的折旧期数（有时也称作资产的使用寿命）。
Period    必需。 您要计算折旧的时期。 Period 必须使用与 life 相同的单位。
Month    可选。 第一年的月份数。 如果省略月份，则假定其值为 12。
使用固定余额递减法，计算一笔资产在给定期间内的折旧值。

```



#### 8.19 DDB 函数

**使用双倍余额递减法或其他指定方法，计算一笔资产在给定期间内的折旧值**

语法

```
DDB(cost, salvage, life, period, [factor])
DDB 函数语法具有下列参数：
Cost    必需。 资产原值。
Salvage    必需。 折旧末尾时的值（有时也称为资产残值）。 该值可以是 0。
Life    必需。 资产的折旧期数（有时也称作资产的使用寿命）。
Period    必需。 您要计算折旧的时期。 Period 必须使用与 life 相同的单位。
Factor    可选。 余额递减速率 如果省略 factor，则假定其值为 2（双倍余额递减法）。
重要: 这五个参数都必须是正数。
用双倍余额递减法或其他指定方法，返回指定期间内某项固定资产的折旧值。

```



#### 8.20 VDB 函数

**使用余额递减法，计算一笔资产在给定期间或部分期间内的折旧值**

语法

```
VDB(cost, salvage, life, start_period, end_period, [factor], [no_switch])
VDB 函数语法具有下列参数：
Cost    必需。 资产原值。
Salvage    必需。 折旧末尾时的值（有时也称为资产残值）。 该值可以是 0。
Life    必需。 资产的折旧期数（有时也称作资产的使用寿命）。
Start_period    必需。 您要计算折旧的起始时期。 Start_period 必须与 life 使用相同的单位。
End_period    必需。 您要计算折旧的终止时期。 End_period 必须与 life 使用相同的单位。
Factor    可选。 余额递减速率。 如果省略影响因素，则假定为 2（双倍余额递减法）。 如果不想使用双倍余额递减法，请更改余额递减速率。 有关双倍余额递减法的说明，请参阅 DDB。
No_switch    可选。 逻辑值，指定当折旧值大于余额递减计算值时，是否转用直线折旧法。
如果 no_switch 为 TRUE，即使折旧值大于余额递减计算值，Microsoft Excel 也不转用直线折旧法。
如果 no_switch 为 FALSE 或被忽略，且折旧值大于余额递减计算值时，Excel 将转用线性折旧法。
重要: 除 no_switch 外的所有参数必须为正数。
使用双倍余额递减法或其他指定方法，返回一笔资产在给定期间（包括部分期间）内的折旧值。 函数 VDB 代表可变余额递减法。

```



#### 8.21 SLN 函数

**计算某项资产在一个期间内的线性折旧值**

语法

```
SLN(cost, salvage, life)
SLN 函数语法具有下列参数：
Cost    必需。 资产原值。
Salvage    必需。 折旧末尾时的值（有时也称为资产残值）。
Life    必需。 资产的折旧期数（有时也称作资产的使用寿命）。
返回一个期间内的资产的直线折旧。

```



#### 8.22 SYD 函数

计算某项资产按年限总和折旧法计算的指定期间的折旧值

语法

```
SYD(cost, salvage, life, per)
SYD 函数语法具有下列参数：
<c0>Cost</c0>    必需。 资产原值。
<c0>Salvage</c0>    必需。 折旧末尾时的值（有时也称为资产残值）。
<c0>Life</c0>    必需。 资产的折旧期数（有时也称作资产的使用寿命）。
<c0>per</c0>    必需。 期间，必须与 life 使用相同的单位。
返回在指定期间内资产按年限总和折旧法计算的折旧。
```



### 9. 数学和三角函数

#### 9.1 SQRT 函数

**计算正平方根**

语法

```
SQRT(number)
SQRT 函数语法具有下列参数：
Number    必需。 要计算其平方根的数字。
返回正的平方根。
```



#### 9.2 QUOTIENT 函数

**返回商的整数部分**

语法

```
QUOTIENT(numerator, denominator)
QUOTIENT 函数语法具有下列参数：
Numerator    必需。 被除数。
Denominator    必需。 除数。
返回除法的整数部分。 要放弃除法的余数时，可使用此函数。
```



#### 9.3 SUMPRODUCT 函数

**计算数组元素的乘积之和**

语法

```
SUMPRODUCT(array1, [array2], [array3], ...)
SUMPRODUCT 函数语法具有下列参数：
Array1    必需。 其相应元素需要进行相乘并求和的第一个数组参数。
Array2, array3,...    可选。 2 到 255 个数组参数，其相应元素需要进行相乘并求和。
在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。
```



#### 9.4 SUMSQ 函数

**计算参数的平方和**

语法

```
SUMSQ(number1, [number2], ...)
SUMSQ 函数语法具有下列参数：
number1, number2, ...    Number1 是必需的，后续数字是可选的。 要对其求平方和的 1 到 255 个参数。 也可以用单一数组或对某个数组的引用来代替用逗号分隔的参数。
返回参数的平方和。

```



#### 9.5 CEILING 函数

**按条件向上舍入**

语法

```
CEILING(number, significance)
CEILING 函数语法具有以下参数：
Number    必需。 要舍入的值。
significance    必需。 要舍入到的倍数。
返回将参数 number 向上舍入（沿绝对值增大的方向）为最接近的指定基数的倍数。 例如，如果您不希望在价格使用所有“分”值，当产品价格为 $4.42 时，则可以使用公式 =CEILING(4.42,0.05) 将价格向上舍入到最接近的 5 美分。

```



#### 9.6 FLOOR 函数

**按条件向下舍入**

语法

```
FLOOR(number, significance)
FLOOR 函数语法具有下列参数：
Number    必需。 要舍入的数值。
significance    必需。 要舍入到的倍数.
将参数 number 向下舍入（沿绝对值减小的方向）为最接近的 significance 的倍数。

```



#### 9.7 SIGN 函数

**获取数值的符号**

语法

```
SIGN(number)
SIGN 函数语法具有下列参数：
Number    必需。 任意实数。
确定数字的符号。 如果数字为正数，则返回 1；如果数字为 0，则返回零 (0)；如果数字为负数，则返回 -1。
```



#### 9.8 MOD 函数

**计算两数相除的余数**

语法

```
MOD(number, divisor)
MOD 函数语法具有下列参数：
Number    必需。 要计算余数的被除数。
Divisor    必需。 除数。
返回两数相除的余数。 结果的符号与除数相同。
```



### 10. 其他函数

#### 10.1 COUNTA 函数

**计算参数中包含非空值的个数**

语法

```
COUNTA(value1, [value2], ...)
COUNTA 函数语法具有下列参数：
value1    必需。 表示要计数的值的第一个参数。
value2, ...    可选。 表示要计数的值的其他参数，最多可包含 255 个参数。
COUNTA 函数计算范围中不为空的单元格的个数。
```



#### 10.2 COUNTBLANK 函数

**计算区域中空白单元格的个数**

语法

```
COUNTBLANK（区域）
COUNTBLANK函数语法具有下列参数：
范围    必需。 需要计算其中空白单元格个数的区域。
COUNTBLANK函数，其中一个统计函数，用于计算单元格区域中的空单元格的个数。
```



#### 10.3 COUNTIF 函数

**计算满足给定条件的单元格的个数**

语法

```
COUNTIF(range, criteria)
参数名称				说明
range（必需）			要进行计数的单元格组。 区域可以包括数字、数组、命名区域或包含数字的引用。 空白和					    文本值将被忽略。
					   了解如何选择工作表中的区域。
criteria   （必需）       用于决定要统计哪些单元格的数量的数字、表达式、单元格引用或文本字符串。
						例如，可以使用 32 之类数字，“>32”之类比较，B4 之类单元格，或“苹果”之类单词。
					    COUNTIF 仅使用一个条件。 如果要使用多个条件，请使用 COUNTIFS。
COUNTIF 是一个统计函数，用于统计满足某个条件的单元格的数量；例如，统计特定城市在客户列表中出现的次数。
```



#### 10.4 COUNTIFS 函数

**计算满足多个给定条件的单元格的个数**

语法

```
COUNTIFS(criteria_range1, criteria1, [criteria_range2, criteria2],…)
COUNTIFS 函数语法具有以下参数：
<c0>criteria_range1</c0>    必需。 在其中计算关联条件的第一个区域。
<c0>criteria1</c0>    必需。 条件的形式为数字、表达式、单元格引用或文本，它定义了要计数的单元格范围。 例如，条件可以表示为 32、">32"、B4、"apples"或 "32"。
<c0>criteria_range2, criteria2, ...</c0>    可选。 附加的区域及其关联条件。 最多允许 127 个区域/条件对。
COUNTIFS 函数将条件应用于跨多个区域的单元格，然后统计满足所有条件的次数。
```



#### 10.5 SUMIFS 函数

**计算多重条件的和**

语法

```
SUMIFS(sum_range, criteria_range1, criteria1, [criteria_range2, criteria2], ...)
参数名称					说明
Sum_range（必需）			 要求和的单元格区域。
Criteria_range1（必需）		  使用 Criteria1 测试的区域。
							Criteria_range1 和 Criteria1 设置用于搜索某个区域是否符合特定条件的搜索							 对。 一旦在该区域中找到了项，将计算 Sum_range 中的相应值的和。
							
Criteria1（必需）			定义将计算 Criteria_range1 中的哪些单元格的和的条件。 例如，可以将条件输入							为 32、">32"、B4、"苹果" 或 "32"。

Criteria_range2, 			附加的区域及其关联条件。 最多可以输入 127 个区域/条件对。
criteria2, …    (optional)
SUMIFS 函数是一个数学与三角函数，用于计算其满足多个条件的全部参数的总量。 例如，可以使用 SUMIFS 计算一个国家/地区内 (1) 邮政编码为同一个且 (2) 利润超过了特定美元值的零售商的总量。

```



#### 10.6 AVERAGEA 函数

**计算参数中非空值的平均值**

语法

```
AVERAGEA(value1, [value2], ...)
AVERAGEA 函数语法具有以下参数：
Value1, value2, ...    Value1 是必需的，后续值是可选的。 需要计算平均值的 1 到 255 个单元格、单元格区域或值。
计算参数列表中数值的平均值（算术平均值）。
```



#### 10.7 AVERAGEIF 函数

**计算满足给定条件的单元格的平均值**

语法

```
AVERAGEIF(range, criteria, [average_range])
AVERAGEIF 函数语法具有下列参数：
Range    必需。 要计算平均值的一个或多个单元格，其中包含数字或包含数字的名称、数组或引用。
Criteria    必需。 形式为数字、表达式、单元格引用或文本的条件，用来定义将计算平均值的单元格。 例如，条件可以表示为 32、"32"、">32"、"苹果" 或 B4。
Average_range    可选。 计算平均值的实际单元格组。 如果省略，则使用 range。
返回某个区域内满足给定条件的所有单元格的平均值（算术平均值）。
```



#### 10.8 RANK.EQ 函数

**返回一个数字在一组数字中的排位**

语法

```
RANK.EQ(number,ref,[order])
RANK.EQ 函数语法具有下列参数：
Number    必需。 要找到其排位的数字。
Ref    必需。 数字列表的数组，对数字列表的引用。 Ref 中的非数字值会被忽略。
Order    可选。 一个指定数字排位方式的数字。
返回一列数字的数字排位。 其大小与列表中其他值相关；如果多个值具有相同的排位，则返回该组值的最高排位。
如果要对列表进行排序，则数字排位可作为其位置。
```



#### 10.9 RANK.AVG 函数

**返回一个数字在一组数字中的排位**

语法

```
RANK.AVG(number,ref,[order])
RANK.AVG 函数语法具有下列参数：
Number    必需。 要找到其排位的数字。
Ref    必需。 数字列表的数组，对数字列表的引用。 Ref 中的非数字值会被忽略。
Order    可选。 一个指定数字排位方式的数字。
返回一列数字的数字排位：数字的排位是其大小与列表中其他值的比值；如果多个值具有相同的排位，则将返回平均排位。

```



#### 10.10 DELTA 函数

**测试两个值是否相等**

语法

```
DELTA(number1, [number2])
DELTA 函数语法具有下列参数：
Number1    必需。 第一个数字。
Number2    可选。 第二个数字。 如果省略，则假设 Number2 值为零。
检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。 可以使用此函数来筛选一组值。 例如，通过对几个 DELTA 函数进行求和，可计算相等对的数量。 此函数也称为 Kronecker Delta 函数。

```



#### 10.11 GESTEP 函数

**测试某值是否大于阈值**

语法

```
GESTEP(number, [step])
GESTEP 函数语法具有下列参数：
Number    必需。 要针对步骤进行测试的值。
Step    可选。 阈值。 如果省略 step 值，则 GESTEP 使用零。
如果 number ≥ step，则返回 1；否则返回 0（零）。 可以使用此函数来筛选一组值。 例如，通过对几个 GESTEP 函数进行求和，可计算超过阈值的值的计数。

```



#### 10.12 IS 类函数

**检验指定值**

语法

```
ISBLANK(value)
ISERR(value)
ISERROR(value)
ISLOGICAL(value)
ISNA(value)
ISNONTEXT(value)
ISNUMBER(value)
ISREF(value)
ISTEXT(value)
IS 函数语法具有下列参数：
value    必需。 指的是要测试的值。 参数 value 可以是空白（空单元格）、错误值、逻辑值、文本、数字、引用值，或者引用要测试的以上任意值的名称。

```

说明

```
这些函数统称为 IS 函数，此类函数可检验指定值并根据结果返回 TRUE 或 FALSE。 例如，如果参数 value 引用的是空单元格，则 ISBLANK 函数返回逻辑值 TRUE；否则，返回 FALSE。
在对某一值执行计算或执行其他操作之前，可以使用 IS 函数获取该值的相关信息。 例如，通过将 ISERROR 函数与 IF 函数结合使用，可以在出现错误时执行其他操作：
= IF ( ISERROR (A1), "出现错误。", A1 * 2)
此公式检验单元格 A1 中是否存在错误情形。 如果存在，则 IF 函数返回消息“出现错误”。 如果不存在，则 IF 函数执行计算 A1*2。
```



## 三、正确建立数据表

### 1. Excel操作常识与技巧

#### 1.1 5项表格操作要点

1.区分工作表与工作簿 

2.调整视图大小

3.增加/删除单元格

4.冻结窗格

5.单元格合并与取消合并 

#### 1.2  Excel的5个技巧



**(1) 定位功能** 

方法是按Ctrl+G键，打开【定位】对话框，如 左下图所示。然后在【定位条件】对话框中，选择需要的定位方式，如定位有错误的公式、定位空值单元格，等等。



**(2) 复制功能**

​	（1）拖动复制。如果输入的内容是序列性的，如1、3、4……或1、3、5……，以及需要输入相同的内容，可以使用拖动复制 的方法来完成。

​	（2）输入时复制。在输入数据时，需要在不连续单元格内输入相同的内容，可以用另外的复制方法。按住Ctrl键选中需要输入的单元格。输入,最后按下Ctrl+Enter键



**(3) 粘贴功能** 

​	Excel复制粘贴有多种形式，尤其是复制带公式、格式的数据 时，就需要灵活使用粘贴功能。合理使用粘贴功能，可以在 使用第三方数据表时，快速将数据复制粘贴到自己的数据表中



**(4) 重复上一步功能**

​	在Excel中使用F4键能重复上一步功能，例如为某单元格设置了字体、颜色、缩进等格式，再切换另外的工作表中，选 中需要进行相同设置的单元格，按下F4键，就自动重复相同的操作了。



**(5) 分列功能** 

​	在建立数据表时常常遇到这样的情况，所获得的数据与实际 需要的数据呈现方式有出入。例如原始数据中，地址列为“ 云南省昆明市官渡区”，但实际需要省份数据、城市数据、 区域数据都单独成列。这种类似的情况都可以使用分列进行 解决



#### 1.3 容易犯的10个错误

**(1) 随意插入空格** 

​	很多新手在制表时容易随意插入空白，认为这样可以更有条 理地显示数据，如右图所示。事实上这样的空白完全没有添 加的意义，并且会导致数据表无法使用分类汇总和透视表功 能分析数据。



**(2) 数值和单位放在一个单元格内**

​	制作数据表时，知道给数据添加单位是一个好事， 但是如何添加单位就体现了专业性。如右图所示， 将数据和单位放在一个单元格内，虽然看起来表意 上没有问题，但是却导致单元格内不是纯数据，无 法进行计算。



**(3) 数据格式不对应** 

​	不同类型的数据都有不同的格式，如日期数据 有对应的日期格式、文本数据有对应的文本格式。格式设置 关系到后期的统计分析能否正确进行。



**(4) 插入空格对齐文字** 

​	单元格中文字长度不一致，如人名有两个字和三个字的人名。为了让文字显示对其，通过添加空格的方法来进行，这是 错误的。正确的设置方法是，选中需要对齐的单元格区域， 单击【开始】选项卡下【数字】组中的对话框启动器 ，打开如右下图所示的【设置单元格格式】对话框，选择对齐方式 为【分散对齐（缩进）】方式



**(5) 数据记录和汇总混合录入**

​	在制作数据表时，为了方便查看数据汇总，有的新手会在原始数据记录表中进行汇总，导致数据记录和汇总记录混合，影响后面数据分析。



**(6) 不必要的工作表划分**

​	一个Excel文件可以建立多张工作表，于是新手就容易轻易分表录入数据，导致后期数据合并统计困难。尤其连续时间段 的数据，更不应该分表录入。



**(7) 插入多行标题**

​	Excel中数据录入过多后，拖动窗口滑块，会看不到 标题行。此时部分新手的解决方法是插入多行标题 ，方便查看数据对应的名称，如右图所示。这是不 应该犯的错误，插入多行标题会导致数据的类型出 现混乱，不方便数据统计分析。要想保持标题行不 消失，可以用前面讲过的冻结窗格功能



**(8) 滥用单元格合并**

​	滥用单元格合并是常见的Excel错误，合并后的单元 格不仅在使用透视表、分类汇总时受限，在使用函 数计算数据时也会有局限性。



**(9) 颜色设计不合理**

​	Excel表格可以针对不同单元格设置填充颜色、文字 颜色、边框颜色。没有设计基础的新手在制作表格 时，很容易为了标新立异，彰显自己的用心制作， 让表格的颜色搭配不合理。这其中有两个主要雷区 ：第一，底色与文字颜色太接近，导致文字显示不 清；第二，颜色太刺眼，不能直视。如右图所示， 该表格标题行文字显示不清，红色底色刺眼。在拿 不准的情况下，建议不设置底色填充，至少能保证 数据清晰可见。也可以使用Excel的【套用表格格式 】功能为表格设计合理的配色



**(10) 一个单元格输入多行数据** 

​	在单元格中输入数据时，按下Alt+Enter键可以换行 ，但是该功能不能随意用。通常情况下，只用于标 题行。在录入数据时，要避免在一个单元格中输入 多行数据。因为Excel计算是以单元格为单位，一个 单元格中有多个数据会引起计算错误。



### 2.  数据表建立的方法

#### 2.1 命名

​	建立数据表，第一步便是正确为数据命名，数据的名称在Excel表中叫字段，后期数据分析计算均是根据字段为依据进 行的。由此可见，命名不规范，可能导致后续分析出现混乱。

**(1) 言简意赅**

**(2) 添加单位**

**(3) 使用术语 / 通用书面语**



#### 2.2 录入和导入数据

**(1) 数据表录入**

​	在表格中输入数据是常见的数据录入法。在前面讲解了如何为数据取名，取名后就可以在下方单元格中对应数据。

​	一维表和二维表记录的数据一样，但是记录方式不同。一维表只有一个维度，但是可以记录多项数据。 二维表有两个缺点，一是记录的数据项目有限；二是不方便使用透视表分析。

​	如果不小心在录入表格中录成了二维表，无须删除重新录入，可以使用工具将其转换成一维表。



**(2) 外部表格导入**

​	在制作数据表时，并不是所有的数据都需要录入。如果手中有现成的数据文档，可以直接导入到Excel数据表中。



**(3) 网页数据导入**

​	在统计数据制作数据表，常常会遇到网页中的数据。面对网页中的数据可以使用导入方法快速添加到 Excel中，并且通过刷新功能获取最新数据。



### 3. 调整数据类型

​	在Excel表格录入数据后，需要查看数据类型是否正确，避免在后期分析时，因为类型错误而出现失误。表格数据类型
有常规型、数值型、货币型、日期型等等。从这些类型的名称就可以看出该类型适合什么样的数据。
​	在表格中，常用到的类型有如下：

1. 数值型：适用于数字型数据，如“4562”、“7152”等。数值型数据可以设置小数位数和使用千位分隔符；
2. 货币型：适用于表示钱财的数据。与数值型类似，不同的是，货币型数据前面会添加货币符号，如“￥1542”；
3. 日期型：适用于表示日期的数据，有多种形式，如“2012年3月14日”、“2012年3月”，只需要根据日期的长短进行
   恰当选择即可；
4. 时间型：适用于表示时间的数据，有多种形式，如“13:50”、“1:30 PM”等，根据需要选择即可；
5. 百分比：适用于表示百分比的数据，可以设置小数位数，如“3.25%”、“95%”等等；
6. 文本：适用于文本型数据，如“北京”、“上海”等等。

​	为表格数据设置数据类型可以在录入数据前，事先设置单元格的数据类型，也可以在数据录入后，设置数据类型。设 置数据类型的方法有两种，一种是在菜单中直接选择，这种方法只能设置默认类型，没有多种选择；另一种是打开【设置 单元格格式】对话框设置，这种方法可以灵活选择。



### 4 修改表格格式

**(1) 掌握格式调整原则**

​	数据分析的原始表格要想美观，需要从如下图所示的原则来考虑：干净, 易阅读, 颜色统一, 数据清晰, 数据对齐, 有层次感, 有间距



**(2) 学会一键格式调整法**

​	学习了上面的知识，是否感到表格格式调整太过复杂，又要注意颜色还要注意字体、间距那么多的项目 。这里有个简单的方法，使用系统预置的格式，实现一键调整。



## 四、数据清洗与加工

**1. 数据加工处理的必要性**

​	数据加工是指对收集到原始数据表进行进一步的处理，使原始数据更符合分析需求。之所 以要进行这一步，是因为一份合乎分析质量的数据，需要具备准确性、完整性、一致性。而收 集到的初始数据，很难具备这三个特征。 



**2. 数据清洗**

​	数据处理的第一步是数据清洗，目的是将多余的、错误的数据清洗出去，留下有 价值的数据。数据清洗要借助Excel工具来进行，能保证清洗效果准确且高效。

**2.1 去重**

**(1) 用删除重复项功能**

​	删除重复项是Excel提供的数据去重功能，可以快速删除重复项。



**(2) 排序删除重复项**

​	除了使用Excel工具的删除重复项功能删 除重复数据，还可以通过排序的方法删除重 复项。通过排序删除重复项，适合于那种需 要人工判断是否真为无用重复项的数据。

​	排序删除重复项的原理是，将数据内容 相同的信息排列到一起，可以一眼看出哪些 数据是重复的，哪些不是重复的。



**(3) 条件格式删除重复项**

​	使用排序的方法删除重复项有一个问题 ，当数据是一串编码时，依然难以用肉眼看 出重复的编码。用条件格式可以自动找出重 复的数据，并手动删除。



**2.2 处理缺省值**

**(1) 一步找出缺省值:定位条件** 

​	在记录数据时，一旦数据量增加，难免出现数据缺省。大多数情况下，缺省的数据会以空白单元格显示。此时不仅需 要将缺省数据检查出来，还要选择合理的处理方式，将缺省数据对数据分析的影响降到最小。

**(2) 替换缺省值**

**(3) 删除缺省值**

**(4) 忽略缺省值**

> 缺省数据和重复数据不一样，重复数据直接删除即可，但是缺省数据却不能草率删除，



**2.3 检查数据逻辑**

**(1) 函数检查逻辑** 

​	函数是Excel的重要功能，它是一些预先定义好的公式，通过特定的参数结构进行计算。函数的功能十分强大，不仅可 以对数据进行计算，还能根据不同的逻辑判断数据正误与否。

​	使用IF函数不仅可以判断数值是否符合特定的范围要求，还可以判断文字是否正确。



**(2) 用条件格式检查逻辑** 

​	如果觉得对函数比较生疏，很难正确输入函数来判断数据的逻辑值正确与否。此时可以使用条件格式来检查逻辑值， 减少了函数使用的困难。



**2.4 检查格式**

​	单元格数据有数值、文本、日期、货币等多种格式。不同类型的数据对应不同的格式，数据的格式有误，将会影响到 后期透视表等功能的使用。因此，数据检查，千万不能忘记格式检查。 

​	在检查数据格式时，尤其应该引起注意的是以下5个格式问题:

日期格式

时间格式 

数值格式的小数位数

数值格式的千位分隔符

百分比格式

**(1) 格式检查的方法** 

​	格式检查的方法比较简单，只需要选中数据 列，在【开始】选项卡下【数字】组中的进行查 看，看选中的数据列是否对应正确的格式。必要 时，可以打开【设置单元格格式】对话框，调整 数据格式。



**(2) 日期格式的修改**

​	在检查数据格式时，如果发现数据格式不对，直接选中数据修改格式即可。但是日期格式的修改却是例外，尤其是当日期的书写方式都不统一时，直接更改格式依然不能使日期格式统一。此时可以选择【分列】功能来实现日期格式的修改 。





## 他山之石



