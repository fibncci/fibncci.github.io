---
layout: post
title: "SAS语言第1遍学习"
date: 2018-07-22
tag: 语言language
---



## sas运行

```
SAS（全称STATISTICAL ANALYSIS SYSTEM，简称SAS）是全球最大的私营软件公司之一，是由美国北卡罗来纳州立大学1966年开发的统计分析软件。
1976年SAS软件研究所（SAS INSTITUTE INC）成立，开始进行SAS系统的维护、开发、销售和培训工作。期间经历了许多版本，并经过多年来的完善和发展，SAS系统在国际上已被誉为统计分析的标准软件，在各个领域得到广泛应用。
中文名:统计分析系统	开发:北卡罗来纳州立大学;地区:美国	;
```

​	同类软件:SPSS, RapidMiner, KNIME,SAP

```shell
安装一个虚拟机，在虚拟机里安装windows操作系统，在虚拟机里跑SAS

SODA（SAS®OnDemand for Academics）是 SAS 为学术届人士免费提供的在线的，基于SAS 私有云上的应用服务环境。利用SODA，我们可以随时随地地在SAS studio中编写运行SAS代码，而且所有数据和代码都可以存储在云端，所有结果均可以下载保存，每个账号用户有5120M的存储空间。SODA可以说是懒人学习SAS最方便、快捷的低成本途径了

Before You Begin
To ensure a trouble-free installation, make sure your OS X computer meets the minimum system requirements:
Mac OS X 10.8 or later
64-bit hardware,
minimum 1GB RAM
One of the following browsers:
Apple Safari 6.0 or later
Mozilla Firefox 21 or later
Google Chrome 27 or later
在你开始之前
为确保安装无故障，请确保你的OS X电脑符合最低系统要求:
Mac OS X 10.8或更高版本
64位的硬件,
最低1 gb RAM
下列浏览器之一:
苹果Safari 6.0或更高版本
Mozilla Firefox 21或更高版本
谷歌Chrome 27或更高版本
```





## SAS体系介绍



```
大纲：
1、SAS安装;2、SAS界面;3、SAS的处理流程;4、SAS的模块
5、逻辑库;6、数据步与过程步举例;7、变量
```

**1、SAS安装**

      SAS的安装比较麻烦，因为网上比较难找到破解版，我花了很大功夫才找到的链接，现在也分享给大家：http://pan.baidu.com/s/1qYHTbkS，链接里有安装教程及安装包，按照上面的教程一步步进行就可以成功安装了。

**2、SAS界面**

    SAS主要由编辑窗口、输出窗、日志窗口构成，编辑窗口主要编辑代码，输出结果显示在输出窗口，日志窗口主要展现警告或报错。

**3、SAS的处理流程**

   SAS的处理流程主要分为数据步和过程步。数据步（data）主要是创建数据集，过程步主要用于分析处理数据集、生成报表和图形。

**4、SAS的模块**

SAS/BASE模块：核心模块。数据管理、交互环境管理、语言处理、调用其它模块

SAS/STAT模块：覆盖几乎所有实用数理统计分析方法，是国际统计分析领域标准

SAS/EM模块：企业级数据挖掘

SAS/IML模块：功能强大面向矩阵运算的编程语言

SAS/GRAPH模块：图形软件包，产生各种图表

SAS/ASSIST模块：面向任务的菜单驱动界面，使用户可以通过菜单使用SAS其它产品

SAS/INSIGHT模块：可视化数据探索工具

SAS/CALC模块：电子表格软件

SAS/ACCESS模块：各种流行数据库接口

**5、逻辑库**

（1） 概念：对应于一条物理路径的逻辑名，用于存放SAS数据集和数据文件。

 （2）创建逻辑库：方法1：通过命令创建。首先，先在硬盘创建相应的目录。然后在编辑窗输入libname命令，例如我在"F:\sas_project\mydb‘’这个目录创建逻辑库，库名就是mydb，则输入命令libname mydb 'F:\sas_project\mydb';，注意路径的单引号和最后的冒号，SAS语句最后都要有冒号，按F8或提交按钮运行命令。

方法2：在逻辑库窗口中的空白处，右键新建逻辑库，弹出的窗口中输入逻辑库名称，选择引擎类型，如果没有特别要求，就选默认，点击路径浏览本地物理地址对应的逻辑库位置，点击确定则创建了一个新的逻辑库。

（3）逻辑库链接数据库：libname 数据库类型 数据库 user=用户名 password=密码 path=链接IP，若数据库为oracle数据库，则数据库类型为oradb，数据库为oracle。

**6、数据步与过程步举例**

```
data mydb.student; #数据步以data开头，将数据输入到mydb这个逻辑库中的student数据集
input id name $ sex $ score;#input输入，输入的变量有id 、name、sex 、score，其中name及sex后都有$这个符号，表示这两个变量的数据为字符类型。
cards;#cards表示输入的是内部数据，而不是从外部文件输入的数据
101 张三 男 98#每列数据以空格分割
102 李四 男 87
103 兰兰 女 95
;
run;#运行
proc print data=mydb.student (keep=id name score);#proc表示过程步的表示，print打印,keep表示只打印id 、name、score这几个变量。
```

run;#运行

        将以上代码运行之后，mydb逻辑库就会出现一个student的数据集，并且本地建立的Mydb也会出现这个数据集，在SAS中删除mydb之后，本地逻辑库和数据集都在，只是SAS的逻辑库没有了，SAS的mydb与本地的Mydb断开了联系。

**7、变量**

（1）命名规则：以字母或下划线开头，由字母、下划线、数字等组成，不区分大小写

（2）变量赋值：

data cr;#没有指明逻辑库，则数据集被放在默认的work逻辑库中

```
y=1;
z='abc';
w="xyz";
run;
```

(3）更多例子

创建sfz数据集：



```
data sfz;
length id $18.;#SAS默认字符长度为8个字符，这里的ID远超过8个字符，所以设定变量的长度，这里为18
input id sex $;
cards;
370825186532435432 M
010356789235875763 F
234567890098765988 M
345432680102300670 F
;
run;
proc print;
run;
```

创建riq数据集：

```
date riq;
cdate="3mar2010"d;#日期格式，后面加d
ctime='7:30't;#时间格式后面加t
cdatetime='6jan2010:8:18:30pm'dt;#日期时间格式，后面加dt
run;
proc print;
format cdate yymmdd10. ctime time10. cdatetime datetime22.;#按照日期格式输出format，cdate按照年月日输出，10个字符，cdatetime按照日期时间格式输出,长度为22。
run;
```

读取外部数据

```
libname temp 'c:\temp';#创建一个temp逻辑库
filename fil "c:\temp\abc.txt";#本地数据路径，并赋给fil变量
data temp.hw;#将外部数据读取给temp逻辑库的hw数据集
infile fil;#infile是读取文件的标志
input h w;#input读入数据
run;
proc print data=temp.hw;#输出temp逻辑库中的hw数据集
run;


```





将数据写出到外部文件

````
data _null_;
set mydb.student;#将mydb逻辑库的student数据集写出到本地文件，路径为'c:\temp\stu1.txt'。
file 'c:\temp\stu1.txt';
put id name $ sex $ score;#put为写出哪些变量
run;


````











## 评价



在使用[sas](https://www.baidu.com/s?wd=sas&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)人的眼里，spss太肤浅了。[sas](https://www.baidu.com/s?wd=sas&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao)学起来比较难，

spss主要是菜单式操作，所有分析直接利用软件自带模块进行，你需要做的就是点击鼠标选菜单。傻瓜式操作，不需要了解一种分析方法的始末就能做分析，还可以做不错的图表。设和做简单的社会学统计和分析。

sas需要从头到尾自己写程序。可以实现很多自己需要的算法。比较适合海量数据处理。
加州大学洛杉矶分校（ucla）对stata、R、sas和spss三个软件的性能对比做了很详细的技术分析，有报告。



SAS是功能强大的统计软件，包含太多内容，比如数据管理、应用开发等，需要更多地知识去驾驭，一般适用于企业。而spss却是界面友好的，且更容易上手，对于医学专业来说，已经足够用了，广泛适用于科研数据分析。spss会更好用。

[北京网数时代科技有限公司](http://www.ndtimes.com.cn/)专业从事spss软件和SAS软件业务，统计软件、环境软件、生化软件、大数据平台等专业科研产品



## 功能模块

SAS (Statistical Analysis System)是一个模块化、集成化的大型应用软件系统。

[![sas8.1安装界面](https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=83eb224be0fe9925cf0c6e5204a95ee4/cc11728b4710b912713ecc70c3fdfc0393452244.jpg)](https://baike.baidu.com/pic/SAS/891078/0/cc11728b4710b912713ecc70c3fdfc0393452244?fr=lemma&ct=single)sas8.1安装界面

它由数十个专用模块构成，功能包括数据访问、数据储存及管理、应用开发、图形处理、数据分析、报告编制、运筹学方法、计量经济学与预测等等。

SAS系统基本上可以分为四大部分：SAS数据库部分；SAS分析核心；SAS开发呈现工具；SAS对分布处理模式的支持及其数据仓库设计。

SAS系统主要完成以数据为中心的四大任务：

1. 数据访问；
2. 数据管理(sas 的数据管理功能并不很出色，而是数据分析能力强大所以常常用微软的产品管理数据，再导成sas数据格式．要注意与其他软件的配套使用）；
3. 数据呈现；
4. 数据分析。当前（2016年）软件最高版本为SAS9.4。其中**Base SAS**模块是SAS系统的核心。其它各模块均在Base SAS提供的环境中运行。用户可选择需要的模块与Base SAS一起构成一个用户化的SAS系统。

 **1.Base SAS**

Base SAS作为SAS系统的核心，负责数据管理，交互应用环境管理，进行用户语言处理，调用其它SAS模块。

Base SAS 为SAS系统的数据库提供了丰富的数据管理功能，还支持标准的SQL语言对数据进行操作。Base SAS能够制作从简单列表到比较复杂的统计报表。 Base SAS可进行基本的描述性统计及基相关 系数的计算，进行正态分布检验等。

备注：提供强大的 数据管理和 描述功能，不管你对数据有什么操作要求，sas都可以实现

**2. SAS/GHAPH**

SAS/GHAPH可将数据及其包含着的深层信息以多种图形生动地呈现出来，如直方图、圆饼图、星形图、散点相关图、曲线图、三维曲面图、等高线图及地理图等。

SAS/GHAPH提供一个全屏幕编辑器，提供多种设备程序，支持非常广泛的图形输出设备以及标准的图形交换文件。
备注： 绘图模块。在9.3 版本开始提供了丰富的绘图功能，可以绘制各种 与 任何软件 媲美的专业图形。

**3. SAS/STAT**

SAS/STAT覆盖了所有的实用数理统计分析方法，是国际统计分析领域的标准软件。SAS/STAT提供了八十多个过程，可进行各种不同模型或不同 特点数据的回归分析，如正交回归/面回归、响应面回归、logistic回归、非线性回归等，且具有多种模型选择方法。 可处理的数据有实型数据、有序数据和属性数据，并能产生各种有用的统计量和诊断信息。

在方差分析方面， SAS/STAT为多种试验设计模型提供了方差分析工具。

另外，它还有处理一般线性模型和广义线性模型的专用过程。在多变量统计方面， SAS/STAT为主成分分析、典型相关分析、判别分析和因子分析提供了许多专用过程。SAS/STAT还包含多种聚类准则的聚类分析方法。

备注： 统计分析模块。 提供上百种分析方法，从简单的统计描述到复杂的模型分析，sas都可以完成



**4.SAS/ETS**

SAS/ETS提供丰富的计量经济学和时间序列分析方法，是研究复杂系统和进行预测的有力工具。它提供方便的模型设定手段、多样的参数估计方法。

备注： 计量经济学和时间序列分析的模块， 
想预测股市的涨跌，想知道公司纪念以后 的 发展趋势，就用它

**5. SAS/QC**

SAS/QC为全面质量管理提供了一系列工具。它也提供一套全屏幕菜单系统引导用户进行标准的统计过程以及试验设计。SAS/QC提供了多种不同类型控制图的制作与分析。Pareto图（排列图）可用于发现需优先考虑的因素，Ishikawa图（鱼骨图）可用于直观地进行因果分析。

备注： 质量控制模块，如果企业想对产品进行最优化设计、可靠性分析、质量控制分析，它是得力工具。





**6.sas/Em**

备注： sas的数据挖掘模块，这是大数据时代必须掌握的工具，像决策树、神经网络等，一些先进的东西都在里面

**7.sas/Genetics**

备注： 遗传分析模块。适合用于生物医学科研人员，但鉴于目前不少对基因的关注，以后会火！

**SAS/ASSIST**

SAS/ASSIST为SAS系统提供了面向任务的菜单界面，借助它可以通过菜单系统来使用SAS系统其它产品。它自动生成的SAS程序既可辅助有经验的用户快速编写SAS程序，又可帮助用户学习SAS。

**SAS/AF**

SAS/AF是一个应用开发工具。用户使用SAS/AF可将包含众多功能的SAS软件作为方法库，利用 SAS/AF的屏幕设计能力以及SCL语言的处理能力来快速开发各种功能强大的应用系统。SAS/AF也了采用了OOP(面向对象编辑)技术，使用户可方便快速开发各类具有图形用户界面(GUI)的应用系统。

**SAS/EIS**

SAS/EIS是决策工具，也是一个快速应用开发工具。SAS/EIS完全采用新兴的面向对象的编程模式(OOP)。EIS以生动直观的方式(图或表)将关键性或总结性信息呈现给使用者。

**SAS/ACCESS**

为了对众多不同格式的数据进行查询、访问和分析，SAS/ACCESS提供了与许多流行数据库软件的接口，利用SAS/ACCESS，可建立外部其它数据库的一个统一的公共数据界面。SAS/ACCESS提供的接口是透明的和动态的。用户不必将此文件当作真正存储着数据的SAS数据集一样使用，而只需在SAS中建立对外部的描述(即VIEW)文件，便可将此文件当作真正存储着数据的SAS数据集一样使用。对一些经常使用的外部数据，可以利用SAS/ACCESS将数据真正提取进入SAS数据库。 SAS/ACCESS 提供的接口是双向的，既可将数据读入SAS，也可在SAS中更新外部数据或将SAS数据加载到外部数据库中。

SAS/ACCESS支持的数据库主要有：IML－DL/I, SQL/DS, DB2, ADABAS, Rdb, ORACLE, Sybase, INGRES, Informix, DBF/DIF,ODBC等。




**SAS/OR**

SAS/OR提供全面的运筹学方法，是一种强有力的决策支持工具。它辅助人们实现对人力、时间以及其它各种资源的最佳利用。 SAS/OR包含通用的线性规划、混合整数规划和非线性规划的求解，也为专门的规划问题提供更为直接的解决办法，如网络流问题、运输问题、分配问题等。

**SAS/IML**

SAS/IML提供功能强大的面向矩阵运算的编程语言，帮助用户研究新算法或解决SAS中没有现成算法的专门问题。SAS/IML中的基本数据元素是矩阵。它包含大量的数学运算符、函数和例行程序，用户用很少的语句便可执行很复杂的计算过程。

**SAS/WA**

SAS/WA（Warehouse Administrator）是建立数据仓库的集成工具，它在其它SAS软件的基础上提供了一个建立数据仓库的管理层，包括：定义[数据仓库](https://baike.baidu.com/item/数据仓库)和主题，数据转换和汇总，汇总数据的更新，Metadata的建立、管理和查询，Data marts和Info marts的实现。

**SAS/MDDB Server**

SAS/MDDB Server是SAS的多维数据库产品，主要用于在线分析处理（OLAP），可将从数据仓库或其它数据源来的数据以立体阵列的方式存储，以便于用多维数据浏览器等工具快速和方便地访问。

**SAS/IntrNet**

SAS/IntrNet为SAS Web应用提供了数据服务和计算服务，包括htmSQL，它为一UNIX Web服务器的CGI程序，使得能通过支持Web浏览器动态查询SAS数据或外部的关系型数据库；SAS ODBC Driver使得能通过支持ODBC的Windows Web服务器来访问SAS数据；SAS Driver for JDBC使得可以通过Java applet来查询SAS数据； SAS/IntrNet Application Dispatcher使得可以通过Web浏览器动态地递交SAS程序到SAS应用服务器执行，并将结果返回浏览器。

**SAS/GIS**

SAS/GIS集地理位置系统功能与数据的显示分析于一体。它提供层次化的地理信息，每一层可以是某些地理元素，也可与用户定义的主题（例如：人口、产值等）相关联。用户可交互式地缩小或放大地图，设定各层次显示与否，并利用各种交互式工具进行数据显示与分析。

备注： 地理信息系统模块，如果你想绘制地图 或者 对不同地区的公司数据进行分析，用它，模块也很漂亮。

**SAS/ITSV**

IT Service Vision（ITSV）是企业的全面IT服务的性能评估和管理的软件，这些IT服务包括计算机系统、网络系统、Web服务器和电话系统等。ITSV将不同来源的数据进行整理和组织，存放于性能数据仓库中，用GUI或批处理的方式产生组织任意层面的报告。系统程序员及网络工程师能借此识别、研究并解决有关问题，业务分析人员能借此制定资源管理的总体策略，CIO和数据中心经理能借此定期地得到所需的IT运作的汇总和分析报告。

**SAS/CFO Vision**

SAS/CFO Vision用于财务整合和报告，内部包含了会计知识，为日常财务工作提供了现成的程序，并提供了访问所有主要数据源的接口。它主要用于；访问财务和非财务的有关住处整合财务数据，通过一个财务信息仓库来管理业务结构，通过财务报告和分析帮助理解财务的结果，并在组织内交流关键的业务结果信息



## 介绍工作环境

文件、编辑、试图、运行、解决方案、窗口、帮助

|文件：|sas文件的打开、关闭、保存、 数据导入、数据导出|
|-|-|
|编辑|撤销、 剪切、复制、 粘贴、选定、清空、查找、替换|
|视图|可切换不同窗口，编辑窗口 、 图形窗口、 日志窗口、结果输出窗口|
|工具|图形、报表等的编辑，以及 对sas 的一些系统设置|
|运行|部分代码、全部代码|
|解决方案|基于菜单式的分析； 数据挖掘、地理信息系统、交互数据分析 等模块|
|窗口| 主要用于哥哥窗口的排列、大小调整等。。。                     |
| 帮助     |各个模块所有命令的帮助，而且带有很多实例；是 最全的sas百科全书|

**输出的格式**

- log文件

- list文件

- data文件

- rtf文件

- sas文件

  

**日志**

````
注:版权所有(c) 2016年由美国北卡罗来纳州凯里市SAS研究所有限公司所有。
注:SAS (r)专用软件9.4 (TS1M6 DBCS3170)
授权给上海知兰医疗器械有限公司，网址11206382。
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA.
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6 DBCS3170)
      Licensed to SHANGHAI KNOWLANDS MEDPHARM CO LTD, Site 11206382.
    
NOTE: 该会话正在平台 W32_10PRO  上执行。

注意:分析产品:
NOTE: Analytical products:

      SAS/STAT 15.1
注:附加主机信息:
NOTE: Additional host information:
 W32_10PRO WIN 10.0.18362  Workstation 工作站

NOTE: “SAS 初始化”所用时间:
      实际时间          9.95 秒
      CPU 时间          1.78 秒


````



第一个程序-输出男女的平均考试成绩

```SAS
data fgsh;
input gender score;
cards;
1 70
1 67
2 83
2 79
1 63
2 71
2 95
1 72
;
proc means;
class gender;
var score;
run;

```

第一个程序-输出男女的平均考试成绩-结果

![sas-day2](../img/sas-day2.png)





## SAS的特点

SAS把数据存取，管理，分析和展现有机地融为一体。主要特点如下：

**1）功能强大，统计方法齐，全，新**

SAS提供了从基本统计数的计算到各种试验设计的方差分析，相关回归分析以及多变数分析的多种统计分析过程，几乎囊括了所有最新分析方法，其分析技术先进，可靠。分析方法的实现通过过程调用完成。许多过程同时提供了多种算法和选项。例如[方差分析](https://baike.baidu.com/item/方差分析)中的多重比较，提供了包括LSD，DUNCAN，TUKEY测验在内的10余种方法；回归分析提供了9种自变量选择的方法（如STEPWISE，BACKWARD，FORWARD，RSQUARE等）。

回归模型中可以选择是否包括截距，还可以事先指定一些包括在模型中的自变量字组（SUBSET）等。对于中间计算结果，可以全部输出，不输出或选择输出，也可存储到文件中供后续分析过程调用。

**2）使用简便，操作灵活**

SAS以一个通用的数据（DATA）步产生数据集，尔后以不同的过程调用完成各种数据分析。其编程语句简洁，短小，通常只需很小的几句语句即可完成一些复杂的运算，得到满意的结果。结果输出以简明的英文给出提示，统计术语规范易懂，具有初步英语和统计基础即可。使用者只要告诉SAS“做什么”，而不必告诉其“怎么做”。同时SAS的设计，使得任何SAS能够“猜”出的东西用户都不必告诉它（即无需设定），并且能自动修正一些小的错误（例如将DATA语句的DATA拼写成DATE，SAS将假设为DATA继续运行，仅在LOG中给出注释说明）。

对运行时的错误它尽可能地给出错误原因及改正方法。因而SAS将统计的科学，严谨和准确与便于使用者有机地结合起来，极大地方便了使用者。

**3）提供联机帮助功能**

使用过程中按下功能键F1，可随时获得帮助信息，得到简明的操作指导。





## 什么sas

```
SAS(Statistical Analysis System )统计分析系统
SPSS（Statistical Product and Service Solutions），“统计产品与服务解决方案”软件。
```

BI 商业智能

- 外文名       :   Business Intelligence
- 别    名      :   商务智能

- 应    用      :    建立信息中心
- 知名厂商   :   微软、IBM、SAP
- 主要市场   :   制造业、金融、电信、零售



sas 9.4 破解版

软件大小：*22.3GB*

软件语言：*简体中文*

软件授权：*免费版*

软件类别：*应用其他*

软件等级：

更新时间：*2018-06-25*

官方网站：www.fixdown.com



```
下载，构造
事件流处理
SAS开发人员经验（含开源）
SAS Analytics Cloud上的SAS机器学习
SAS可视化分析
SAS可视化数据挖掘机器学习
SAS可视化建模统计工具
所有试用

SAS®可视化数据挖掘和机器学习
在单一内存环境中使用最新统计、文本分析和机器学习算法加快数据探索和模型开发。
```



**导航**



````
文件夹名：统计分析关键技术
文件名：合理选择统计分析方法
1、值得分析与否
面对给定的资料，首要回答的问题：
不是：选用什么方法？
而是：是否值得分析？
有精彩课件与您分享！

2、呈现数据结构
常见数据结构
（1）数据库结构
（2）析因设计结构
（3）矩阵结构
3、弄清分析目的 -关注：
差异性、相关性、关联性、依赖性、分类、聚类、评价、估计、预测

4、检查前提条件
具体有哪些前提条件，取决于资料性质、拟选用的统计分析方法和希望结果的精度高低等。

5、提出具体要求
如：三种特殊检验，需要给定合适的界值；
贝叶斯统计，需要给定先验概率和 /或先验分布

````



```
感悟统计学的真谛
胡良平
LPHU812@SINA.COM
www.statwd.com
www.huasitai.com
邀请函
欢迎加入“世界中医药学会联合会临床科研统计学专业委员会”
可填写入会申请表提交：
邮箱：lckyjtx@163.com
你统计学我
```

```
1.从统计计算角度考量
基于常识与数学给出定义式
概率分布本身的导出与计算
基于概率分布直接导出公式
基于概率分布的区间估计
基于概率分布的假设检验
6、基于最小二乘原理的参数估计
7、基于最大似然原理的参数估计
8、基于广义估计方程的参数估计
9、基于贝叶斯理论的估计与检验
0、基于蒙特卡洛方法估计与检验
1、基于数值与迭代计算求解过程

二、从统计应用角度考量
1、会判断资料是否值得分析
2.把握统计分析的关键步骤
3、把握常见问题与数据结构
4、清楚统计分析方法的分类
5、会辨析多因素的设计类型
6、会识别各种列联表资料
7、会基于统计分析目的从数据库中提取分析的信息实现统计计算
8、会使用软件实现统计分析
9、会正确解读大量输出结果
0、会结合实际陈述专业结论

1、会判断资料是否值得分析
不值得分析的数据有
1)人为编造的数据
2)设计有严重硬伤的数据
(3)质量控制不严的数据
(4)经错误方法整理的数据
(5)缺失值多的数据
(6)问卷回收率低的数据
```



## SAS学习笔记

1 新建逻辑库

工具栏——new library——输入name、path、勾选启动默认enable at startup

查看一下：菜单——view——explorer

2 新建数据集

方法1

Explorer——右键单击——new——table——输入数据，点击保存——选择逻辑库，填写名称——save

方法2

Solutions——analysis——analyst——输入数据，点击保存——选择逻辑库，填写名称——save

3 导入外部数据

FILE——Import data——勾选标准数据源standard data soruce ——路径不能有中文字符

4 排序

File——open——excel.sas7bdat文件

Data——sort——选择排序的字段——sort by——ascend 升序、dascend降序——reset重新设置

5 筛选

Data——filter——subset data——选择GE大于等于——《constant enter value》——3

就是筛选subset data大于等于3，none是取消

6 转置

Data——transpose——选择列——transpose转置——group by 分租

7 频率分析

Statistics统计——descriptive描述——频率分析frequency——选择分析的字段

Input 显示顺序  plots 条形图【hor水平vert垂直】

Tables 输出内容





**Sas语法基础**

```

2.1 创建客户信息数据集
libname jx 'e:\sas\jx';
data jx.custer;
input id name $ sex $ money
cards;
1001 zhangfei men 98
1002 liubei men 76
1003 daocan women 54
;
run;


proc print data=jx.custer;
run;
2.2 建立与文件连接的逻辑库
libname jxsj 'e:\sas\jx' compress=yes;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
sas如何连接sql2000数据库
odbc连接方式
建立odbc数据源:控制面板-管理工具-数据源(odbc)
 
 
代码实现:
Libname jmssql odbc user='sa' password='' dsn=mssql ; 
Oledb连接方式

 
代码实现
libname sqlbase oledb provider=sqloledb.1 properties=("Data Source"=MY3KQFHEPCPN95N "User ID"=sa "Password"=''  "Initial Catalog"=KIS_Sample);
输出数据
proc print data=Jmssql.t_Balance;
run;
2.3 sql过程连接关系数据库
定义odbc连接变量
/*%let jx_connect=user='sa' password='' dsn='mssql';*/

定义oledb连接变量
%let jx_connect=user='sa' password='' provider=sqloledb.1 properties=("Data Source"=MY3KQFHEPCPN95N "User ID"=sa "Password"=''  "Initial Catalog"=KIS_Sample);;

proc sql ;
validate;
connect to oledb (&jx_connect);
	select * into :v_sj from connection to oledb
	(select FDate from t_Voucher);
	/*execute (create table jxc as  select * from t_Voucher ) by oledb;*/
	disconnect from oledb;
quit;

在表中定义变量并赋值
data  wo.bl;
x=2;
y='abc';
run;
定义变量sf长度为18字符
data wo.custer;
length sf $18.;
input name $ sf;
cards;
zhangfei 1234567890
liubei 9123456780
;
run;

y自动转为数值参加计算
data qsum;
x=1;
y='2';
sum=x+y;
run;
连接运算,数字转化为字符
data substr;
y=10;
ch='hellow';
v_sub=ch||y;
run;

字符替换与提取字符
Substr(s,p,n)从字符串s中的第p个字符开始提取n个字符的子串。
data substr1;
y=12345678;
转为12位字符,前面填充4个0
ch=substr(y,5,6);
bc=Ktruncate(y,5,6);
ch2=substr(y,5,3);
bc2=Ktruncate(y,5,3);
run;

常量赋值
data cl;
cl1='i love you!';
cl2="i'm zhangfei";
cl3='ni shi "xi gua"';
run;
日期常量
data dtime;
c1='3mar2012'd;
c2='8:30't;
c3='6apr2012:8:18:30pm'dt;
run;
proc print;
/*format c1 yymmdd10. c2 time10. c3 datetime22.;*/
format c1 yymmdd. c2 time. c3 datetime.;
run;

if语句
libname wo 'E:\sas';
data wo.custer;
input id $ level $ amount 5. @;
label id='bianhao' level='jibie' amount='edu';
cards;
1001 a 2000
1002 b 2003
1003 b 3000
1004 c 5000
1005 d 6000
;
data wo.alei wo.blei wo.clei;
set wo.custer;
if level='a' then output wo.alei;
	else if level='b' then output wo.blei;
	else output wo.clei;
run;

proc print ;
title "[c lei xin yong ka]";
run;

读取前3条记录
libname wo 'E:\sas';
data wo.custer;
input id $ level $ amount 5. @;
label id='bianhao' level='jibie' amount='edu';
cards;
1001 a 2000
1002 b 2003
1003 b 3000
1004 c 5000
1005 d 6000
;
data wo.new1;
set wo.custer;
if _n_<3 then output wo.new1;
run;

proc print data=wo.new1;
title "[new1  xin yong ka]";
run;
select when判断语句
libname wo 'E:\sas';
data wo.custer;
input id $ level $ amount 5. @;
label id='bianhao' level='jibie' amount='edu';
cards;
1001 a 2000
1002 b 2003
1003 b 3000
1004 c 5000
1005 d 6000
;
data wo.alei wo.blei wo.clei;
set wo.custer;
select (level);
when ('a') output wo.alei;
when ('b') output wo.blei;
otherwise  output wo.clei;
end;
run;
select when 修改符合条件的记录
proc print data=wo.blei;
title "[blei  xin yong ka]";
run;
libname wo 'E:\sas';
data wo.custer;
input id $ level $ amount 5. @;
label id='bianhao' level='jibie' amount='edu';
cards;
1001 a 2000
1002 b 2003
1003 b 3000
1004 c 5000
1005 d 6000
;
data wo.new2;
set wo.custer;
select;
when (level='a')  level='m';
when (level='b')  level='n';
otherwise  level='s';
end;
run;

proc print data=wo.new2 label;
title "[new2  xin yong ka]";
run;
do while循环语句:先判断在执行
libname wo 'E:\sas';
data wo.custer;
input id $ level $ amount 5. @;
label id='bianhao' level='jibie' amount='edu';
cards;
1001 a 2000
1002 b 2003
1003 b 3000
1004 c 5000
1005 d 6000
;
run;
data wo.new3;
	x=0;
	do while(x<11);
		x=x+2;
	end;
	put x=;
run;
x=12
do until循环语句:先执行再判断

data wo.new3;
	x=0;
	do until(x<11);
		x=x+2;
	end;
	put x=;
run;
x=2
do to循环语言
data wo.new4;
x=0;
do i=1 to 9 by 2;
	x=i+1;
end;
run;
操作符
data wo.new4;
y=2**3;乘方
x=5/2;除
run;
and & or|,||连接,!!连接
宏变量 %let
格式修饰符 冒号
对于数据长度大小不定的列,加:冒号,防止读错列.
对于有空格的列,加&,保留空格
对于有引号,分隔号的列,加~
data wo.new4;
input name $ address &:$20. zone $ @;
cards;
zhangfei  zhongguo beijing fengtaiqu  100070
liubei  beijing xichengqu  100000
guanyu  zhongguo shandong  272195
;
run ;
指针控制 读取文件
%let lujing='D:\jx\tx.txt';
filename tx0 "(&lujing)";
data new5;
	infile tx0;
	input @1 qh $4. @5 address $17. @22 youbian $4.
	;
run;
proc print;
run;

@行控制符号
%let lujing='d:\jx\credtype.txt';
filename  cred1 "(&lujing)";
data wo.xinyongka;
	infile cred1;
	input  @20 card_type $1.
			@;
			if card_type='B' then do;
				input @1 credt_bh $3.
						@4 card_num $16.
						;
						output wo.xinyongka;
			end;
	run;
	proc print data=wo.xinyongka noobs;
	run;
@@换行
data cust_inf;
length address $20.;
input name $ address @@;
cards;
liubei beijingfengtai zhangyuhua hebeitangxian dongxiaoqing jiangsunanjing
;
run;
proc print data=cust_inf;
var name address;
run;


put 数据输出到外部文件
%let lujing='d:\jx\filewrite.txt';
filename wbsj "(&lujing)";
data wo.gs;
	infile wbsj;
	input @1 credt_bh $3.
			@4 num $16.
			@20 type $1.
			;

run;
%let lujing='e:\sas\filewrite.txt';
filename wbsj2 "(&lujing)";
data _null_;
	file wbsj2;
	set wo.gs;
put @1 credt_bh $3.
	@4 '|'
	@5 num $16.
	@21 '|'
	@22 type $1.
	;
run;

读取外部文件，从第一条到第5条
%let lujing='e:\sas\test1.txt';
%let filename="&lujing";
data wo.test1;
	infile &filename missover lrecl=300 firstobs=1 obs=5;
	input f1 $ 
		f2 $ 
		f3 $ 
		;
run;

输出数据到外部文件
data _null_;
	set wo.test1;
	file 'e:\sas\test2.txt';
	put f1 $ 
	s '|'
	f2 $ 
	b '|'
	f3 $ 
	;
run;



在mssql中建表
create table jx_inf(id char(8),host varchar(15),address varchar(30),fees numeric(5,1),time_len numeric(4),arrears_count numeric(3),last_mtimel datetime default getdate(),curr_mtimel datetime ,next_mtimel datetime);

insert into jx_inf values('12345676','刘小红','北京市丰台区丰台总部',300,20,7, CONVERT(varchar(100),'2014-04-17 09:01:10', 20),convert(varchar(100),'2014-04-16 10:01:10',20),convert(varchar(100),'2014-04-18 12:01:10',20))
将数据库中的表输出到文件

%let a='MY3KQFHEPCPN95N';
%let b='sa';
%let c='';
%let d='testdb';
libname myku1 oledb provider=sqloledb.1 properties=("Data Source"=&a "User ID"=&b "Password"=&c  "Initial Catalog"=&d);  
%let out='e:\sas\cust_inf.dat';

data _null_;
	file &out lrecl=134;
set myku1.jx_inf;
	put  @1 id $8.
		@9 '|'
		@10 host $15.
		@25 '|'
		@26 address $30.
		@56 '|'
		@57 fees 5.1
		@62 '|'
		@63 time_len 4.0
		@67 '|'
		@68 arrears_count 3.0
		@71 '|'
		@72 last_mtimel datetime8.1
		@80 '|'
		@81 curr_mtimel datetime8.1
		@89 '|'
		@90 next_mtimel datetime8.1
		@98 '|'
		;
注意：日期无法显示
run;




读取bat文件，‘，’为分割符
%let lujing='d:\jx\bl.dat';
filename wbwj "(&lujing)";
data bl;
	infile wbwj dlm=',';
	length fh $50.;
		input bh $ fh jyl cs sr;
run;



读取日期格式
data  card1;
	input id $ name $ dt date.;
	cards;
	1001 gaoxiaohong 10mar12
	1002 liuxiaoxia 18mar12
	;
run;

proc print label;
	format dt yymmdd10.;
run;
informat与format定义格式
data card2;
	informat dt mmddyy10.;
	length dq $30.;
	input dq $ dt;
	cards;
	beijing 10-23-2010
	shandong 09-08-2011
	;
run;
proc print ;
	format dt yymmdd10.;
run;



数组
data tt;
array temp1(2) $ ('a' 'b');
y=temp1(2);
put y=;
run;
系统选项option
%macro define_op(v_bh);
option obs=2 compress=yes;
option mlogic mprint ;

%let dir='d:\jx\bl.bat';
filename wbwj "(&dir)";
data blsj;
	infile wbwj dlm=',';
	length fh $50.;
	input bh $ fh jyl cs sr;
run;

proc sql;
	select * from blsj where bh=&v_bh;
quit;

%mend define_op;
%define_op('01002');

```










## 参考文献

```she e
sas学习笔记
http://note.youdao.com/noteshare?id=90cec609acdfba969fde84e9fa2ea3ba&sub=WEBd52c4ca06fce28fc474ae5691032ec16
```

```
SAS笔记
https://wenku.baidu.com/view/cbe73a4a5f0e7cd185253656.html
SAS 画图 学习笔记
https://wenku.baidu.com/view/1d3fdc220508763230121271?sxts=1569123715148

SAS® 产品文档（中文）
http://support.sas.com/documentation/navigation/zh/zh_doc.html

sas使用手册
https://wenku.baidu.com/view/4a15673a580216fc700afd90.html
```

