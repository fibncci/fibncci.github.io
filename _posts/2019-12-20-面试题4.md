---
layout: post
title: "面试题4"
date: 2019-12-20
tag: sas
---







## 第一题

```sql
1. CREATE TABLE A (Member_ID varchar(255), Log_time datetime, URL varchar(255));

2. 
# 时间最早, 这个用户记录数是指: 理财相关的用户记录数
SELECT A.URL,
(SELECT COUNT(1) FROM A JOIN B ON A.URL = B.URL WHERE Member_ID = a_out.Member_ID AND Log_class = '理财')
FROM A a_out JOIN B ON a_out.URL = B.URL
WHERE Log_class = '理财' 
AND Log_time = 
(SELECT MIN(Log_time) FROM A WHERE Member_ID = a_out.Member_ID AND  Log_class = '理财')

3. 
-- UPDATE 如何做 JOIN
UPDATE A JOIN B ON A.URL = B.URL SET Member_ID = '0002567543' WHERE Log_time BETWEEN '2018-05-13 00:00:00' AND '2018-05-13 23:59:59' AND B.Log_class='购物'
```

## 第二题



```
# 1. DATE_FORMAT(sale_ord_tm, 'YYYY/HH/DD') 

SELECT city_name, DATE_FORMAT(sale_ord_tm, 'YYYY/HH/DD') AS '日期', COUNT(1) AS '订单总量', MIN(price) AS '最低价格'
FROM A JOIN B ON A.city_id = B.city_id
GROUP BY DATE_FORMAT(sale_ord_tm, 'YYYY/HH/DD'), A.city_id
```

```
SELECT Name, AVG(math) as '数学平均成绩', avg(chinese) AS '语文平均成绩'
FROM CC GROUP BY Name
```

```sql
SELECT Name,
MIN(CASE WHEN class = '高一' THEN chinese ELSE NULL END) AS '高一语文',
MIN(CASE WHEN class = '高二' THEN chinese ELSE NULL END) AS '高二语文',
MIN(CASE WHEN class = '高三' THEN chinese ELSE NULL END) AS '高三语文',
MIN(CASE WHEN class = '高一' THEN math ELSE NULL END) AS '高一数学',
MIN(CASE WHEN class = '高二' THEN math ELSE NULL END) AS '高二数学',
MIN(CASE WHEN class = '高三' THEN math ELSE NULL END) AS '高三数学'
FROM CC GROUP BY Name;
```

```
SELECT Name,  SUM(math) + SUM(chinese) as 'Total_score'
FROM CC WHERE (class, Name) NOT IN (SELECT class, Name FROM CCC) GROUP BY Name
ORDER BY Total_score
;
```

