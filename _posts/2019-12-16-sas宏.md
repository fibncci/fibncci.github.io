SAS(R) 9.3 Macro Language: Reference

## 宏语句

宏语言语句指示宏处理器执行操作。它由一串关键字，SAS名称，特殊字符和运算符组成，并以分号结尾。某些宏语言语句仅在宏定义中使用，但您可以在SAS会话或作业中的任何位置，在宏定义的内部或外部使用其他语言（称为开放代码）。



## ％ABORT语句

句法

```
％ABORT <ABEND | 取消<文件> | 返回| < *Ñ* > > ;
语法
%ABORT <ABEND | CANCEL <FILE> | RETURN | <*n*> > ;
```





必填参数

- 结束

  导致当前宏和SAS作业或会话异常终止。结果取决于操作方法：批处理模式和非交互模式。立即停止处理。向SAS日志发送一条错误消息，指出执行已被％ABORT宏语句的ABEND选项终止不执行任何后续语句或检查语法将控制权返回给操作环境。进一步的操作取决于您的操作环境和站点如何处理异常结束的作业。窗口环境和交互式线条模式。使您的宏，窗口环境和交互式行模式立即停止处理，并使您返回到操作环境。

- 取消<文件>

  导致取消当前提交的语句。结果取决于操作方法。如果操作方法是批处理模式和非交互模式，请使用CANCEL选项执行以下操作：整个SAS程序和SAS系统终止。错误消息将写入SAS日志。如果操作方法是窗口化环境和交互式线路模式，请使用CANCEL选项执行以下操作：它仅清除当前提交的程序。其他后续提交的程序不受影响。错误消息将写入SAS日志。如果操作方法是工作区服务器和存储过程服务器，请使用CANCEL选项执行以下操作：它仅清除当前提交的程序。其他后续的提交呼叫不受影响。错误消息将写入SAS日志。如果操作方法是SAS IntrNet应用程序服务器，请使用CANCEL选项执行以下操作：将为每个请求创建一个单独的执行。执行提交请求代码。请求代码中的CANCEL清除当前提交的代码，但不终止执行或SAS会话。文件当编码为autoexec文件或％INCLUDE文件中CANCEL参数的选项时，％ABORT语句仅清除autoexec文件或％INCLUDE文件的内容。其他提交的源语句将在autoexec或％INCLUDE文件之后执行。**限制：**不能使用SAS / SHARE，SAS / CONNECT或SAS / AF提交CANCEL参数。警告：在％INCLUDE文件中执行％ABORT CANCEL FILE选项时，将关闭所有打开的宏，并在下一个源代码行恢复执行。

- 返回

  导致当前宏和SAS作业或会话异常终止。结果取决于操作方法：批处理模式和非交互模式立即停止处理向SAS日志发送一条错误消息，指出执行已由％ABORT宏语句的RETURN选项终止不执行任何后续语句或检查语法使用指示错误的条件代码将控制返回给操作环境窗口环境和交互式线条模式使您的宏，窗口环境和交互式行模式立即停止处理，并使您返回到操作环境

- *ñ*

  一个整数值，使您可以指定条件代码：与CANCEL参数一起使用时，该值放置在SYSINFO自动宏变量中。如果不将其与CANCEL语句一起使用，则在执行停止时SAS会将值返回到操作环境。*n*的值范围取决于您的操作环境。

细节

如果不指定任何参数，则％ABORT宏语句将在以下操作方法下产生这些结果：



比较

％ABORT宏语句使SAS停止处理当前宏和DATA步骤。接下来会发生什么取决于

％ABORT宏语句通常出现在％IF-％THEN宏语句的子句中，该子句旨在在发生错误情况时停止处理。

**注意：**如果有效的系统选项ERRORABEND，则SAS将忽略％ABORT宏语句生成的返回码。

**注意：**在DATA步骤中执行％ABORT宏语句时，SAS不会使用在该步骤中创建的数据集来替换具有相同名称的现有数据集。





％*宏注释声明

％COPY声明

％DISPLAY语句

％DO语句

％DO，迭代语句

％DO％UNTIL语句

％DO％WHILE语句

％END语句

％GLOBAL声明

％GOTO声明

％IF-％THEN /％ELSE语句

％INPUT语句

％label声明

％LET语句

％LOCAL语句

％MACRO声明



## ％MEND声明



％MEND声明

结束宏定义。

| 类型： | 宏语句           |
| ------ | ---------------- |
| 限制： | 仅在宏定义中允许 |

```
％MEND < *宏名称* > ;

%MEND <*macro-name*> ;
```





必填参数

- *宏名*

  在宏定义结束时命名宏。重复宏的名称是可选的，但为了清楚起见，它很有用。如果指定*macro-name*，则％MEND语句中的名称应与％MACRO语句中的名称相匹配；否则，SAS发出警告消息。



示例：结束宏定义

```
％macro disc（dsn）;
   数据＆dsn;
      设置perm.dataset;
      其中month =“＆dsn”;
   跑;
％修补光盘；

%macro disc(dsn);
   data &dsn;
      set perm.dataset;
      where month="&dsn";
   run;
%mend disc;
```





％PUT语句

％RETURN语句

％SYMDEL语句

％SYSCALL语句

％SYSEXEC语句

％SYSLPUT语句

％SYSMACDELETE语句

％SYSMSTORECLEAR语句

％SYSRPUT语句

％WINDOW语句





## 参考文献

```
http://support.sas.com/documentation/cdl/en/mcrolref/62978/HTML/default/viewer.htm#n01mgvwt7f9smen159ad334ts4ha.htm
SAS(R) 9.3 Macro Language: Reference

```

